(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5638],{10946:(e,t,n)=>{"use strict";n.d(t,{A:()=>v,u:()=>p});var r=n(50979),s=n(25963),a=n(75612),l=n(13780),i=n(30386),o=n(70375),c=n(45588),d=n(31754),m=n(47654),u=n(67906),x=n(42419),h=n(94815),j=n(10150),p=function(e){return e.Vercel="vercel",e}({});let v=e=>{let{name:t}=e,[{userStatus:n}]=(0,c.Jd)(),{query:p,pathname:v}=(0,o.c)(),{code:g,state:b,error:f,next:y}=p,w=(0,i._)(),N=(0,s.useMemo)(()=>"string"==typeof f?f:null,[f]),k=(0,s.useMemo)(()=>null!=N&&N.length<200,[N]),{routes:I,navActions:T}=(0,o.c)(),C=(0,l.Z)(5e3),E=(0,s.useMemo)(()=>"string"==typeof b?b:"",[b]);return(0,a.Z)(async()=>{if(n===c._O.signedIn&&null==N&&null!=t&&"string"==typeof t&&null!=g&&"string"==typeof g)try{let{data:e}=await w.completeLogin({name:t,code:g,state:E});(e=>{let{projectId:t,page:n}=e;"string"==typeof y&&""!==y?window.location.href=y:"profile"===n?T.replace(I.account({})):null!=t?T.replace(I.projectIntegrations({projectId:t})):T.replace(I.dashboard({}))})(e)}catch(e){T.replace({url:v,nextAs:v,query:{error:e.message}})}},[n,t,g,N,E]),(0,r.jsxs)(h.S,{children:[(0,r.jsx)(u.h,{y:6}),C&&null==N&&n===c._O.signedIn&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(x.EY,{children:["Authenticating ",t,"..."]}),(0,r.jsx)(u.h,{y:4}),(0,r.jsx)(d.vx,{href:"/",children:"Go Home"})]}),null!=N&&(0,r.jsxs)("div",{className:"text-center max-w-md",children:[(0,r.jsx)(u.h,{y:4}),(0,r.jsxs)(x.lD,{children:[t," authentication failed"]}),(0,r.jsx)(x.yn,{children:k?N:"There was a problem authenticating you with ".concat(t)}),(0,r.jsxs)(x.EY,{className:"text-center",children:["If this problem persists, please"," ",(0,r.jsx)(m.N,{variant:"underline",...I.help({}),children:"reach out"}),"."]})]}),n===c._O.signedOut&&(0,r.jsx)(j.az,{authState:{next:window.location.href}})]})}},25322:(e,t,n)=>{"use strict";n.d(t,{V:()=>l});var r=n(45588),s=n(97865),a=n(55850);let l=()=>{let{graphqlClient:e}=(0,a.q)(),[{user:t}]=(0,r.Jd)(),{result:n}=(0,s.W)(["vercel",null==t?void 0:t.id],async()=>(await e.vercelInfo({})).vercelInfo,{retry:1});return n}},30386:(e,t,n)=>{"use strict";n.d(t,{$:()=>d,_:()=>c});var r=n(1363),s=n(21328),a=n(5979),l=n(97865),i=n(55850),o=n(72898);let c=()=>({login:async(e,t)=>{window.location.href=s.p.loginIntegration(t,{name:t,...e})},completeLogin:async e=>{let{data:t,integrationAuthId:n}=await r._W(e);return{data:null!=t?t:{},integrationAuthId:n}}}),d=e=>{let{graphqlClient:t}=(0,i.q)(),{result:n,queryKey:r,setQuery:s}=(0,l.W)(["integrations",e],async()=>(0,a.nX)(await t.getIntegrationInfo({projectId:e}))),c=(0,o.n)(r,async n=>{let{name:r,config:s,integrationAuthId:a}=n;await t.integrationCreate({input:{projectId:e,name:r,config:s,integrationAuthId:a}})}),d=(0,o.n)(r,async r=>{var a,l,i,o;let{id:c,name:d,config:m,integrationAuthId:u}=r;s({integrationAuths:null!=(i=null==(a=n.data)?void 0:a.integrationAuths)?i:[],integrations:(null!=(o=null==(l=n.data)?void 0:l.integrations)?o:[]).map(e=>e.id===c?{...e,config:m}:e)}),await t.integrationUpdate({id:c,input:{projectId:e,name:d,config:m,integrationAuthId:u}})}),m=(0,o.n)(r,async e=>{var r,a,l,i;s({integrationAuths:null!=(l=null==(r=n.data)?void 0:r.integrationAuths)?l:[],integrations:(null!=(i=null==(a=n.data)?void 0:a.integrations)?i:[]).filter(t=>t.id!==e)}),await t.integrationDelete({id:e})});return[n,{createIntegration:c,updateIntegration:d,deleteIntegration:m}]}},37515:(e,t,n)=>{"use strict";function r(e,t){var n=0,r=0;return Float64Array.from(e,void 0===t?e=>n+=+e||0:s=>n+=+t(s,r++,e)||0)}n.d(t,{A:()=>r})},54378:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});var r=n(10946),s=n(5979),a=n(97865),l=n(55850);let i=e=>{let{configurationId:t}=e,{graphqlClient:n}=(0,l.q)();return(0,a.W)(["integrationAuth",r.u.Vercel,t],async()=>{if(null==t)throw Error("configurationId is null");return(0,s.nX)(await n.integrationAuth({provider:r.u.Vercel,providerId:t})).integrationAuth},{enabled:null!=t})}},54811:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>t1});var r=n(50979),s=n(4036),a=n(86739),l=n(13025),i=n(81154),o=n(25963),c=n(1142),d=n(93208),m=n(98888),u=n(52992),x=n(70375),h=n(49852),j=n(52060),p=n(2551),v=n(77505),g=n(45588),b=n(12645),f=n(47188),y=n(2590),w=n(15857),N=n(36609),k=n(31754),I=n(75749),T=n(13077),C=n(47654),E=n(67970),P=n(42419),S=n(88887),R=n(58956),M=n(79931),A=n(13934),U=n(2888),_=n(25508),D=n(44039),W=n(86422),B=n(95662),V=n(76933),F=n(18970),z=n(50380),G=n(90029);let L=()=>{let e=(0,i.md)(w.T6),t=(0,i.md)(f.uV),n=(0,y.I)(),s=(0,W.C)(),a=(0,i.md)(D.vA),{routes:l,navActions:c,isMetro:m}=(0,x.c)(),{modalActions:u}=(0,v.U)(),{isConfirmed:h}=(0,d.S)(),[{userStatus:j}]=(0,g.Jd)(),[b,N]=(0,_.b)(),{attemptAction:I}=(0,S.lh)(),C=(0,o.useMemo)(()=>{var t;return null!=(t=null==e?void 0:e.plugins)?t:[]},[null==e?void 0:e.plugins]),E=async(e,t)=>{await h({confirmLabel:"Delete",input:t,message:"Are you sure you want to delete the plugin ".concat(t,"? All data associated with this plugin will be removed forever."),title:"Delete plugin",type:"input"})&&await I({action:()=>s.removePlugin({id:e}),successMessage:"Done!",failureMessage:"Failed to remove ".concat(t),loadingMessage:"Removing ".concat(t," plugin")})},R=async(e,t)=>{await h({confirmLabel:"Delete",title:"Delete Service",message:"Are you sure you want to delete the service ".concat(t,"? All data associated with this service will be removed forever."),input:t,type:"input"})&&await I({action:()=>n.deleteService(e),successMessage:"Done!",failureMessage:"Failed to remove ".concat(t),loadingMessage:"Removing ".concat(t," service")})},M=async()=>{if(null!=e&&await h({confirmLabel:"Delete",input:"I confirm that I want to delete the project ".concat(e.name),message:(0,r.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,r.jsxs)("p",{children:["Are you sure you want to delete the project ",(0,r.jsx)("i",{children:e.name}),"? This includes all services, environments and data."]}),(0,r.jsx)("p",{className:"text-center",children:(0,r.jsxs)("b",{children:["The project will be"," ",(0,r.jsx)("span",{className:"text-danger",children:"permanently deleted"})," in 48 hours."]})}),(0,r.jsx)("p",{children:"You can cancel or force delete the project during the 48 hour grace period. Active deploys will be stopped in the interim."})]}),title:"Delete Project",type:"input"})){try{u.openModal((0,r.jsx)(G.Cg,{text:"Deleting the ".concat(e.name," project"),messages:[]})),await n.scheduleDeleteProject({id:e.id}),u.createToast((0,r.jsx)(S.y8,{variant:"success",title:"Your project is being deleted.",description:"You will have 48 hours to cancel the deletion."}),10),j===g._O.signedIn?c.push(l.dashboard({})):c.push(l.home({}))}catch(e){N(e.message)}u.exitModal()}};return null==e?null:(0,r.jsxs)(B.T,{space:12,className:"max-w-measure",children:[null!=b&&(0,r.jsx)(P.yn,{children:b}),(0,r.jsxs)(B.T,{space:6,children:[(0,r.jsxs)(P.f_,{children:["Manage ",m?"Services":"Plugins"]}),(0,r.jsxs)(O,{children:["Deleting ",m?"services":"plugins"," from a project will permanently delete all data and deployments for that"," ",m?"service":"plugin"," in all environments."]}),C.length+e.services.length>0?(0,r.jsx)(F.J6,{children:(0,r.jsx)(F.XI,{children:(0,r.jsxs)(F.vc,{showRowBorder:!0,children:[C.map(e=>{let n=U.Gg[e.name];return null==n?null:(0,r.jsxs)(F.fI,{unSelectable:!0,className:"flex items-center justify-between",children:[(0,r.jsx)(F.xC,{children:(0,r.jsxs)(B.z,{align:"center",space:4,children:[null!=n.icon&&(0,r.jsx)(T.In,{icon:n.icon}),(0,r.jsx)(P.EY,{children:n.text})]})}),(0,r.jsx)(F.xC,{className:"",children:(0,r.jsx)(V.m,{content:"Only workspace admins can remove plugins",disabled:t,children:(0,r.jsx)(k.$n,{variant:"outline",color:"red",disabled:!t,onClick:()=>E(e.id,e.name),size:"sm",className:"remove-plugin",children:"Remove"})})})]},e.id)}),e.services.map(e=>{let n=null!=e.icon?()=>(0,r.jsx)(p.xfq,{src:e.icon}):null;if(null==n){var s,l;let t=(0,D.Zd)({config:a,serviceId:e.id});n=(null==t||null==(s=t.source)?void 0:s.image)!=null?p.azJ:(null==t||null==(l=t.source)?void 0:l.repo)!=null?p.gqo:p.BKt}return(0,r.jsxs)(F.fI,{unSelectable:!0,className:"flex items-center justify-between",children:[(0,r.jsx)(F.xC,{children:(0,r.jsxs)(B.z,{align:"center",space:4,children:[(0,r.jsx)(T.In,{icon:n}),(0,r.jsx)(P.EY,{children:e.name})]})}),(0,r.jsx)(F.xC,{children:(0,r.jsx)(k.$n,{color:"red",variant:"outline",disabled:!t,onClick:()=>R(e.id,e.name),size:"sm",className:"remove-service",title:t?void 0:"Only workspace admins can remove services",children:"Remove"})})]},e.id)})]})})}):(0,r.jsxs)(P.xC,{className:"flex items-center justify-center w-full border border-dashed border-gray-200 p-4 rounded-lg",children:["You have no ",m?"services":"plugins"," yet"]})]}),(0,r.jsxs)(B.T,{space:6,children:[(0,r.jsx)(P.f_,{as:"h2",children:"Delete Project"}),(0,r.jsxs)(O,{children:["Deleting the project will ",(0,r.jsx)("strong",{children:"permanently delete"})," all data stored in the project plugins for all environments. This can't be undone."]}),(0,r.jsx)(z.V,{message:"Only workspace admins can delete projects",showTooltip:!t,children:(0,r.jsx)(k.$n,{color:"red",disabled:!t,onClick:M,className:"max-w-max delete-project",children:"Delete Project"})})]})]})},O=e=>{let{children:t,...n}=e;return(0,r.jsxs)(B.z,{align:"center",space:4,...n,className:"text-red-500 border border-red-500 rounded-md px-4 py-2",children:[(0,r.jsx)(T.In,{icon:p.hcu}),(0,r.jsx)(P.ax,{children:t})]})};var $=n(12725),Y=n(50253),J=n.n(Y),q=n(41110),H=n.n(q),X=n(61649),Z=n(42043),K=n(35645),Q=n(17057),ee=n(89088),et=n(80430),en=n(49767),er=n(29056);let es=()=>{let e=(0,i.md)(w.T6),{routes:t,isMetro:n}=(0,x.c)(),{modalActions:s}=(0,v.U)(),a=(0,o.useMemo)(()=>{var t;return(null!=(t=null==e?void 0:e.environments)?t:[]).filter(e=>!e.isEphemeral)},[e]),l=(0,Z.m)({projectId:null==e?void 0:e.id}),c=(0,o.useMemo)(()=>l.data?l.data.project.environments.reduce((e,t)=>{let n=t.patches[0];return n&&(e[t.id]=n),e},{}):{},[l.data]);return(0,r.jsxs)(B.T,{className:"space-y-12",children:[(0,r.jsxs)(B.T,{children:[(0,r.jsx)(P.f_,{as:"h2",className:"mb-4",children:"Environments"}),(0,r.jsxs)(P.xC,{className:"mb-6",children:["Each environment gives you an isolated instance of each"," ",n?"service":"plugin","."," ",(0,r.jsxs)(C.N,{variant:"underline",...t.docs({page:"develop/environments"}),children:["Read the docs",(0,r.jsx)(T.In,{icon:p.GrD,size:"xs",className:"!inline-block ml-1"})]})]}),(0,r.jsx)(eo,{environments:a,latestEnvironmentPatches:c}),(0,r.jsx)(A.n4,{children:(0,r.jsx)(k.$n,{size:"sm",className:"max-w-max mt-4",icon:p.FWt,onClick:()=>{s.openModal((0,r.jsx)(er.N,{}))},children:"New Environment"})})]}),(0,r.jsx)(el,{})]})},ea=()=>{var e;let t=(0,i.md)(w.T6),n=(0,i.md)(f.mz),s=(0,y.I)(),{modalActions:a}=(0,v.U)(),l=async e=>{try{await s.updateProject({botPrEnvironments:e}),a.createToast((0,r.jsx)(S.y8,{variant:"success",title:e?"Bot PR environments enabled":"Bot PR environments disabled",description:e?"Railway will now create environments for PRs opened by bots.":"Railway will no longer create environments for PRs opened by bots."}))}catch(e){a.createToast((0,r.jsx)(S.y8,{variant:"error",title:"Error updating Bot PR Environments",description:e.message}))}};return(0,r.jsxs)(B.T,{className:"mt-8",children:[(0,r.jsx)(en.fV,{children:"Bot PR Environments"}),(0,r.jsxs)(en.M7,{children:["Railway will create environments for PRs opened by bots. We currently support"," ",(0,r.jsx)(C.N,{variant:"underline",href:"https://github.com/dependabot",children:"Dependabot"})," ","and"," ",(0,r.jsx)(C.N,{variant:"underline",href:"https://github.com/renovatebot",children:"Renovate"}),"."]}),(0,r.jsx)(en.FE,{children:(0,r.jsx)(ee.N,{id:"bot-pr-envs",disabled:!n,checked:null!=(e=null==t?void 0:t.botPrEnvironments)&&e,onCheckedChange:l,children:"Enable Bot PR Environments"})})]})},el=()=>{let e=(0,i.md)(w.T6),t=(0,i.md)(f.mz),n=(0,y.I)(),s=(0,o.useMemo)(()=>{var t;return(null!=(t=null==e?void 0:e.environments)?t:[]).filter(e=>e.isEphemeral)},[e]),{modalActions:a}=(0,v.U)(),l=async e=>{try{await n.updateProject({prDeploys:e}),a.createToast((0,r.jsx)(S.y8,{variant:"success",title:e?"Future PRs will be deployed":"Future PRs will not be deployed anymore"}))}catch(e){var t;a.createToast((0,r.jsx)(S.y8,{variant:"error",title:null!=(t=e.message)?t:"Error updating project"}))}};return(0,r.jsxs)("div",{children:[(0,r.jsx)(P.f_,{as:"h2",className:"mb-4",children:"PR Environments"}),(0,r.jsx)(P.xC,{className:"mb-6",children:"Environments automatically created by Railway when a pull request is opened and cleaned up when the PR is closed."}),s.length>0&&(0,r.jsx)(eo,{environments:s,isEphemeral:!0}),(0,r.jsx)(k.$n,{variant:"outline",color:"gray",size:"sm",disabled:!t,onClick:()=>l(!(null==e?void 0:e.prDeploys)),className:"mt-2 max-w-max",children:(null==e?void 0:e.prDeploys)?"Disable PR Environments":"Enable PR Environments"}),(null==e?void 0:e.prDeploys)&&(0,r.jsx)(ei,{}),(null==e?void 0:e.prDeploys)&&(0,r.jsx)(ea,{})]})},ei=()=>{var e,t;let n=(0,i.md)(w.T6),s=(0,i.md)(f.mz),a=(0,y.I)(),l=null!=(e=null==n?void 0:n.environments)?e:[],o=null!=(t=null==n?void 0:n.baseEnvironmentId)?t:"",{modalActions:c}=(0,v.U)(),{isConfirmed:m}=(0,d.S)(),u=async e=>{var t;let n=l.find(t=>t.id===e);null==n||n.name;try{await a.updateProject(e?{baseEnvironmentId:e}:{baseEnvironmentId:null})}catch(e){c.createToast((0,r.jsx)(S.y8,{variant:"error",title:null!=(t=e.message)?t:"Error updating project"}))}};return(0,r.jsxs)("div",{className:"flex flex-col mt-8",children:[(0,r.jsx)(en.fV,{children:"Base Environment"}),(0,r.jsx)(en.M7,{children:"Variables from this environment will be used in the PR Environment. If no base environment is defined, the environment connected to the destination branch will be used."}),(0,r.jsx)(et.l,{name:"base environment",value:o,disabled:!s,label:{text:"Base environment",hidden:!0},onChange:u,options:[{value:"",text:"No base environment"}].concat(l.filter(e=>!e.isEphemeral).map(e=>({value:e.id,text:e.name})))})]})},eo=e=>{let{environments:t,isEphemeral:n,latestEnvironmentPatches:s}=e,a=(0,i.md)(w.T6),l=(0,i.md)(b.Zy),o=(0,i.md)(f.DM),c=(0,y.I)(),[m,u]=(0,_.b)(),{isConfirmed:h}=(0,d.S)(),{modalActions:j}=(0,v.U)(),{attemptAction:p}=(0,S.lh)(),{navActions:g,routes:N}=(0,x.c)(),k=async(e,t)=>{try{if(!await h({confirmLabel:"Delete",input:t,message:"Are you sure you want to delete this environment? All data associated with this environment will be permanently deleted.",title:"Delete environment",type:"input"}))return;await p({action:()=>c.deleteEnvironment({id:e}),loadingMessage:"Removing ".concat(t,"..."),successMessage:"Successfully deleted environment ".concat(t),failureMessage:"Failed to delete environment ".concat(t)})}catch(e){u(e.message)}if((null==l?void 0:l.id)===e){if(!a)return;let t=[...a.environments].sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()).find(t=>t.id!==e);g.push(N.projectEnvironments({projectId:a.id,environmentId:null==t?void 0:t.id}))}j.exitModal()},{openCommandPalette:I}=(0,X.oG)(),T=async e=>{let n=t.find(t=>t.id===e);null!=n&&I({id:"rename-environment",type:"input",prompt:"Environment name",initialValue:n.name,validate:e=>{let r=t.some(t=>t.id!==n.id&&t.name===e);return(0,$.validateEnvironmentName)(e)&&!r},crumbs:["Rename environment"],action:async t=>{t&&await c.renameEnvironment({id:e,name:t})}})},C=(n||1!==t.length)&&o.Admin,E=H()(t,[e=>e.createdAt,e=>e.name]);return(0,r.jsxs)(r.Fragment,{children:[null!=m&&(0,r.jsx)(P.yn,{children:m}),(0,r.jsx)(F.J6,{children:(0,r.jsxs)(F.XI,{children:[n&&(0,r.jsx)(F.D1,{children:(0,r.jsxs)(F.fI,{children:[(0,r.jsx)(F.A3,{children:"Name"}),(0,r.jsx)(F.A3,{children:"Pull Request"}),(0,r.jsx)(F.A3,{})]})}),(0,r.jsx)(F.vc,{showRowBorder:!0,children:E.map(e=>(0,r.jsx)(ec,{environment:e,latestPatch:(null!=s?s:{})[e.id],isActive:e.id===(null==l?void 0:l.id),canDelete:C,permissions:o,onDeleteEnvironment:k,onRenameEnvironment:T},e.id))})]})})]})},ec=e=>{var t,n,s,a;let{environment:l,latestPatch:i,isActive:o,canDelete:c,permissions:d,onDeleteEnvironment:m,onRenameEnvironment:u}=e,h=(0,y.I)(),{routes:j,navActions:v}=(0,x.c)();return(0,r.jsxs)(F.fI,{unSelectable:!c,className:"environment",children:[(0,r.jsx)(F.xC,{className:"environment",onClick:()=>{v.push(j.project({projectId:l.projectId,environmentId:l.id})),h.setActiveEnvironment(l.id)},children:(0,r.jsxs)(P.EY,{className:"flex items-center",children:[o&&(0,r.jsx)(T.In,{icon:p.Jlk,className:"text-pink-600 mr-2",size:"sm"}),(0,r.jsx)("span",{children:l.name})]})}),null!=l.meta&&(0,r.jsx)(F.xC,{className:"cursor-default !max-w-[120px]",children:(0,r.jsxs)("a",{className:"flex items-center gap-2 text-gray-500 hover:text-gray-800",href:"https://github.com/".concat(l.meta.prRepo,"/pull/").concat(l.meta.prNumber),target:"_blank",children:[(0,r.jsx)(T.In,{icon:p.lg3,size:"sm"}),(0,r.jsx)(P.EY,{className:"truncate",title:null!=(s=null==(t=l.meta)?void 0:t.prTitle)?s:"",children:null!=(a=null==(n=l.meta)?void 0:n.prTitle)?a:""})]})}),(0,r.jsx)(F.xC,{className:"text-gray-500 text-right text-sm cursor-default items-center justify-end",children:null!=i&&!l.isEphemeral&&(0,r.jsxs)(B.z,{align:"center",className:"max-w-max ml-auto",children:["Updated ",J()(i.appliedAt).fromNow()," ",(0,r.jsx)(K.e,{...i.appliedBy,className:"ml-2",size:"xxs"})]})}),d.Write&&(0,r.jsx)(F.xC,{className:"w-[44px] cursor-default",children:(0,r.jsxs)(Q.ms,{children:[(0,r.jsx)(Q.Lk,{icon:p.GvN,title:"Deployment actions",className:"w-9 h-9 flex items-center justify-center"}),(0,r.jsxs)(Q.pm,{align:"end",children:[(0,r.jsx)(Q.tJ,{onSelect:()=>{u(l.id)},name:"Rename",children:"Rename"}),c&&(0,r.jsx)(Q.tJ,{onSelect:()=>{m(l.id,l.name)},name:"Delete",className:"text-red-500",children:"Delete"})]})]})})]},l.id)};var ed=n(42113),em=n(5041),eu=n(61259),ex=n(86954),eh=n(36893),ej=n(36725);let ep=e=>{var t,n,s;let{project:a}=e,l=(0,i.md)(f.mz),c=(0,y.I)(),[d,m]=(0,_.b)(),{register:u,formState:x,handleSubmit:h,reset:j}=(0,ed.mN)({defaultValues:{name:a.name,description:null!=(s=a.description)?s:""}}),{errors:v}=x;(0,o.useEffect)(()=>{var e;j({name:a.name,description:null!=(e=a.description)?e:""})},[a.name,a.description]);let g=async e=>{let{name:t,description:n}=e;try{j({name:t,description:n}),await c.updateProject({name:t,description:n})}catch(e){m("Updating project failed")}};return(0,r.jsx)("div",{className:"project-info",children:(0,r.jsxs)(eu.lV,{enableBindings:!0,onSubmit:h(g),onCancel:()=>j(),name:"Update Project",className:"space-y-6",children:[null!=d&&(0,r.jsx)(P.yn,{children:d}),(0,r.jsx)(ex.pd,{readOnly:!l,error:null==v||null==(t=v.name)?void 0:t.message,...u("name",{required:"Project name is required",validate:e=>e.length>$.MAX_LENGTHS.PROJECT_NAME?"Project name must be less than ".concat($.MAX_LENGTHS.PROJECT_NAME," characters"):void 0}),label:"Name",placeholder:"awesome project","data-testid":"project-name-input"}),(0,r.jsx)(ex.pd,{readOnly:!l,error:null==v||null==(n=v.description)?void 0:n.message,...u("description",{required:!1,validate:e=>null==e||e.length>$.MAX_LENGTHS.PROJECT_DESCRIPTION?"Project description must be less than ".concat($.MAX_LENGTHS.PROJECT_DESCRIPTION," characters"):void 0}),label:"Description",placeholder:"Optional description of this project"}),(0,r.jsxs)(B.T,{children:[(0,r.jsx)(ex.JU,{children:"Project ID"}),(0,r.jsx)(em.$,{children:a.id})]}),a.expiredAt&&(0,r.jsxs)(P.EY,{className:"text-yellow-800 project-warning",children:["This project is temporary and will be removed on"," ",(0,r.jsx)(ej.g,{children:a.expiredAt})," (",(0,r.jsx)(eh.s,{children:a.expiredAt}),")"]}),(0,r.jsxs)(B.z,{space:4,align:"center",justify:"between",children:[(0,r.jsx)(k.$n,{disabled:!x.isDirty,children:"Update"}),x.isDirty&&(0,r.jsx)(k.$n,{type:"button",variant:"ghost",color:"gray",icon:p.$Jj,onClick:()=>j(),children:"Undo Changes"})]})]})})};var ev=n(30386),eg=n(25322),eb=n(54378),ef=n(67906);let ey=n(10946).u.Vercel,ew=e=>{let{projectId:t}=e,{login:n}=(0,ev._)();return(0,r.jsx)(k.$n,{variant:"outline",onClick:()=>n({projectId:t},ey),className:"max-w-max mx-auto",children:"Connect to Vercel"})},eN=e=>{var t;let{projectId:n,vercelAccounts:s,connectedIntegration:a,integrationAuths:l}=e,c=(0,i.md)(w.T6),[,d]=(0,ev.$)(n),[m,u]=(0,_.b)(),[x,h]=(0,o.useState)(!1),j=(0,o.useMemo)(()=>s.find(e=>e.isUser),[s]),p=(0,o.useMemo)(()=>{if(null==a)return{account:null!=j?j.id:s[0].id,project:"select",productionEnvironment:"select",previewEnvironment:"select"};{var e,t;let n=a.config;return{account:n.accountId,project:n.projectId,productionEnvironment:null!=(e=n.productionEnvironmentId)?e:"select",previewEnvironment:null!=(t=n.previewEnvironmentId)?t:"select"}}},[a]),{watch:v,handleSubmit:g,control:b,formState:{errors:f}}=(0,ed.mN)({defaultValues:p}),y=v(),N=(0,o.useMemo)(()=>{var e,t;return null!=(t=null==(e=s.find(e=>e.id===y.account))?void 0:e.projects)?t:[]},[y.account,s]),I=(0,o.useMemo)(()=>{let e=s.find(e=>e.id===y.account);return null==l?void 0:l.find(t=>t.id===(null==e?void 0:e.integrationAuthId))},[s,y.account,l]),{result:T}=(0,eb.x)({configurationId:null!=(t=null==I?void 0:I.providerId)?t:null}),C=(0,o.useMemo)(()=>{var e;return null==(e=T.data)?void 0:e.integrations.filter(e=>null==a||e.config.projectId!==a.config.projectId).map(e=>e.config.projectId)},[null==T?void 0:T.data,a]),S=(0,o.useMemo)(()=>JSON.stringify(p)!==JSON.stringify(y),[p,y]),R=async e=>{let t=e.account,n=e.project,r="select"===e.productionEnvironment?null:e.productionEnvironment,l="select"===e.previewEnvironment?null:e.previewEnvironment;try{if(null==r&&null==l)throw Error("At least one environment must be set");let e=s.find(e=>e.id===t);if(null==e)throw Error("Account not found");let i=e.projects.find(e=>e.id===n);if(null==i)throw Error("Project not found");let o={accountId:e.id,isUserAccount:e.isUser,projectId:i.id,projectName:i.name,productionEnvironmentId:r,previewEnvironmentId:l};h(!0),null!=a?await d.updateIntegration({config:o,id:a.id,name:ey,integrationAuthId:e.integrationAuthId}):await d.createIntegration({name:ey,config:o,integrationAuthId:e.integrationAuthId})}catch(e){u(e.message)}h(!1)};return null==c?(0,r.jsx)(E.m6,{}):(0,r.jsxs)(eu.lV,{onSubmit:g(R),name:"Configure Vercel",children:[null!=m&&(0,r.jsx)(P.yn,{children:m}),(0,r.jsxs)(B.T,{space:4,children:[(0,r.jsx)(ed.xI,{name:"account",control:b,rules:{required:!0,validate:e=>"select"!==e},render:e=>{let{field:{onChange:t,value:n,name:a}}=e;return(0,r.jsx)(et.l,{value:n,label:"Connect to account",onChange:e=>t(e),name:a,error:null!=f.project,options:[...s.map(e=>{var t,n;return{text:null!=(n=null!=(t=e.name)?t:e.slug)?n:"<Unknown team>",value:e.id}})]})}}),(0,r.jsx)(ed.xI,{name:"project",control:b,rules:{required:!0,validate:e=>"select"!==e},render:e=>{let{field:{onChange:t,value:n,name:s}}=e;return(0,r.jsx)(et.l,{value:n,label:"Connect to project",onChange:e=>t(e),name:s,error:null!=f.project,options:[{text:"Select project",value:"select"},...N.filter(e=>!(null!=C?C:[]).includes(e.id)).map(e=>({text:e.name,value:e.id}))]})}}),(0,r.jsx)(ed.xI,{name:"productionEnvironment",control:b,render:e=>{let{field:{onChange:t,value:n,name:s}}=e;return(0,r.jsx)(et.l,{value:n,onChange:e=>t(e),name:s,label:"Production environment",options:[{text:"No environment",value:"select"},...c.environments.map(e=>({text:e.name,value:e.id}))]})}}),(0,r.jsx)(ed.xI,{name:"previewEnvironment",control:b,render:e=>{let{field:{onChange:t,value:n,name:s}}=e;return(0,r.jsx)(et.l,{value:n,label:"Preview environment",onChange:e=>t(e),name:s,options:[{text:"No environment",value:"select"},...c.environments.map(e=>({text:e.name,value:e.id}))]})}}),S&&"select"!==y.project&&(0,r.jsx)(k.$n,{disabled:x,children:x?(0,r.jsx)(E.Rh,{}):null!=a?"Update":"Connect"})]})]})},ek=()=>(0,r.jsxs)(B.T,{align:"center",className:"py-2",children:[(0,r.jsx)(B.z,{justify:"center",align:"center",children:(0,r.jsx)(T.In,{icon:p.yXl,size:"2xl"})}),(0,r.jsxs)(B.T,{align:"center",children:[(0,r.jsx)(P.TT,{className:"my-6",children:"Vercel"}),(0,r.jsx)(P.xC,{className:"text-center",children:"Connect Railway environments to production and preview deploys on Vercel"})]})]}),eI=[{name:"Vercel",value:"vercel",component:e=>{let{projectId:t,integrationInfo:{integrationAuths:n,integrations:s}}=e,a=(0,o.useMemo)(()=>s.find(e=>e.name===ey),[s]),l=(0,eg.V)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ek,{}),(0,r.jsx)(ef.h,{y:4}),null==a&&(null==n?void 0:n.length)===0?(0,r.jsx)(ew,{projectId:t}):null==l.data?(0,r.jsx)(E.m6,{}):(0,r.jsx)(eN,{projectId:t,connectedIntegration:a,vercelAccounts:l.data.accounts,integrationAuths:n})]})}}];function eT(){let e=(0,a._)(["grid gap-2 grid-cols-[repeat(auto-fit,_min(346px,_100%))]"]);return eT=function(){return e},e}function eC(){let e=(0,a._)(["\n  relative flex flex-col p-8 w-full bg-background border border-gray-200 rounded-lg\n"]);return eC=function(){return e},e}function eE(){let e=(0,a._)(["\n  absolute top-1 right-1 opacity-50 hover:opacity-100\n"]);return eE=function(){return e},e}let eP=e=>{let{projectId:t}=e,[n,{deleteIntegration:s}]=(0,ev.$)(t),{isConfirmed:a}=(0,d.S)(),l=(0,i.md)(f.mz),o=async e=>{await a({confirmLabel:"Remove",message:"Are you sure you want to remove this integration from the project?",title:"Remove Integration"})&&await s(e)};return n.isLoading?(0,r.jsx)(E.m6,{}):l?(0,r.jsx)(eS,{children:eI.map(e=>{var s;let a=e.component,l=null==(s=n.data)?void 0:s.integrations.find(t=>t.name===e.value);return(0,r.jsxs)(eR,{children:[(0,r.jsx)(a,{projectId:t,integrationInfo:n.data}),null!=l&&(0,r.jsx)(eM,{title:"Remove Integration",icon:p.X,onClick:()=>o(l.id)})]},e.value)})}):(0,r.jsx)(P.EY,{children:"You do not have permission to view this page"})},eS=N.qy.div(eT()),eR=N.qy.div(eC()),eM=(0,N.DR)(k.K0)(eE());var eA=n(73648),eU=n(71144),e_=n(46251),eD=n(82660),eW=n(15887),eB=n(47096),eV=n(80068),eF=n(22986),ez=n(70578),eG=n(45479),eL=n(26447),eO=n(25952),e$=n(10733);let eY=e=>{var t,n;let{projectId:s,ownershipTransferId:a,open:l,onOpenChange:i}=e,[{user:c}]=(0,g.Jd)();(0,eL.vg)();let{modalActions:d}=(0,v.U)(),m=(0,eF.useRouter)(),u=(0,o.useMemo)(()=>{if(null==c)return[];let e=[];for(let r of c.workspaces){var t,n;(!r.team||r.team.teamPermissions.some(e=>e.userId===c.id&&e.role===eG.acM.Admin))&&e.push({title:null!=(t=r.name)?t:"Personal Workspace",subscriptionModel:r.subscriptionModel,workspaceId:r.id,hasActiveSub:r.customer.state===eG.zZZ.Active||r.customer.state===eG.zZZ.PastDue,avatar:null!=(n=r.avatar)?n:c.avatar})}return e},[c,s]),[x,h]=(0,o.useState)(null!=(n=null==(t=u[0])?void 0:t.workspaceId)?n:null),[j,p]=(0,o.useState)(!1),[,b]=(0,ez.Ff)(s),[f,y]=(0,_.b)(),w=async()=>{if(null!=x){p(!0);try{await b.confirmOwnershipTransfer({projectId:s,destinationWorkspaceId:x,ownershipTransferId:a}),m.replace({pathname:m.pathname,query:{projectId:s}}),d.createToast((0,r.jsx)(S.y8,{title:"Ownership Transfer completed",variant:"success"})),null==i||i(!1)}catch(e){y(e.message)}p(!1)}};return(0,r.jsx)(e$.a.Root,{open:l,onOpenChange:i,title:"Transfer Project",visuallyHideTitle:!0,children:(0,r.jsxs)("div",{className:"max-w-md","data-testid":"transfer-project-modal",children:[null!=f&&(0,r.jsx)(P.yn,{children:f}),(0,r.jsxs)(B.T,{space:4,children:[(0,r.jsx)(G.wt,{children:"Transfer Project"}),(0,r.jsx)(G.xW,{children:"Please choose the workspace you would like to transfer the project to:"})]}),(0,r.jsxs)(eu.lV,{className:"mt-6 space-y-6 w-full",onSubmit:w,children:[(0,r.jsx)(eO.z6,{defaultValue:null!=x?x:void 0,onValueChange:e=>h(e),className:"space-y-1",children:u.map(e=>(0,r.jsxs)("label",{htmlFor:e.workspaceId,className:(0,N.xW)("flex items-center justify-between","px-4 py-3 rounded-md","cursor-pointer hover:bg-pink-50",null!=x&&e.workspaceId===x?"bg-pink-50":"bg-gray-50"),children:[(0,r.jsxs)(B.z,{align:"center",space:3,children:[(0,r.jsx)(eO.qj,{value:e.workspaceId,id:e.workspaceId,children:(0,r.jsx)(eO.kl,{})}),(0,r.jsxs)(B.T,{children:[(0,r.jsx)(P.EY,{children:e.title}),(0,r.jsx)(P.tj,{className:"text-gray-500 capitalize",children:e.hasActiveSub?e.subscriptionModel===eG.VEo.Team?"Pro plan":e.subscriptionModel===eG.VEo.User?"Hobby plan":"Unknown plan":"Trial plan"})]})]}),(0,r.jsx)(K.e,{name:e.title,avatar:e.avatar,size:"sm"})]},e.workspaceId))}),(0,r.jsxs)(B.z,{justify:"end",align:"center",space:4,className:"w-full",children:[(0,r.jsx)(k.$n,{type:"button",variant:"outline",onClick:()=>d.exitModal(),children:"Cancel"}),(0,r.jsx)(k.$n,{type:"submit",disabled:null==x||j,isLoading:j,children:"Transfer project"})]})]})]})})},eJ=e=>{let{ownershipTransferId:t,projectId:n}=e,{showModal:s}=(0,u.h)(),[{user:a}]=(0,g.Jd)(),{routes:l,navActions:i}=(0,x.c)(),o=async()=>{s(eY,{projectId:n,ownershipTransferId:t})};return(null==a?void 0:a.isVerified)?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(eD.l,{variant:"info",className:"items-start md:items-center mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col space-y-5 items-start md:flex-row md:space-x-10 md:items-center md:space-y-0",children:[(0,r.jsx)(P.EY,{children:"Upon confirming, the ownership of this project will be transferred to you and you'll be billed for the usage of this project for your entire billing cycle. This includes usage it has incurred before today."}),(0,r.jsx)(k.$n,{onClick:o,children:"Confirm"})]})})}):(0,r.jsx)(eD.l,{variant:"info",className:"items-start md:items-center mb-6",children:(0,r.jsxs)("div",{className:"w-full flex flex-col space-y-5 items-start md:flex-row md:space-x-10 md:items-center md:space-y-0 justify-between",children:[(0,r.jsx)(P.EY,{children:"Please upgrade your plan to take ownership of this project"}),(0,r.jsx)(k.vx,{size:"sm",color:"blue",...l.workspaceUpgrade({}),children:"Upgrade"})]})})};function eq(e){var t;let{project:n}=e,{isConfirmed:s}=(0,d.S)(),{navActions:a,routes:l,query:c}=(0,x.c)(),[{user:m}]=(0,g.Jd)(),u=(0,i.md)(f.DM),h=(0,i.md)(e_.G),{workspace:j}=(0,eA.hA)(),{track:v}=(0,eU.j)(),b=async()=>{if(n.teamId)return!1;let e=await s({cancelLabel:"Invite to project",confirmLabel:"Create a team",message:"Project invites are primarily for hobbyist developers, students and users experimenting with the plaform. If you're working on a product and are part of a team, please consider upgrading to the Pro plan instead.",theme:"info",title:"Create a team?"});return e&&(v({action:"Click",object:"Create a team",properties:{projectId:n.id}}),a.push(l.newWorkspace({}))),e},y=(0,o.useMemo)(()=>m&&n.teamId&&null!=m.workspaces.find(e=>{var t;return(null==(t=e.team)?void 0:t.id)===n.teamId}),[m,n]),w=n.projectPermissions.length,N=null==h?void 0:h.project.members,k=N&&w>=N;return(0,r.jsxs)(r.Fragment,{children:[(null==j?void 0:j.teamId)&&(0,r.jsxs)("div",{className:"pb-8",children:[(0,r.jsx)("h4",{className:"mb-4 text-h4 font-semibold",children:"Workspace"}),(0,r.jsxs)("p",{className:"flex items-center gap-x-2",children:[(0,r.jsx)("span",{children:"All members of "}),y||(null==m?void 0:m.isAdmin)?(0,r.jsxs)(C.N,{...(null==m?void 0:m.isAdmin)?l.adminTeams({id:null!=(t=null==j?void 0:j.teamId)?t:void 0}):l.account({}),className:"flex items-center space-x-2",children:[(0,r.jsx)(K.e,{...j,size:"xs"}),(0,r.jsx)("span",{className:"text-pink-500",children:j.name})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(K.e,{...j,size:"sm"}),(0,r.jsx)("span",{className:"text-pink-500",children:j.name})]}),(0,r.jsx)("span",{children:"can access this project."})]})]}),u.Write&&(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("h4",{className:"mb-4 text-h4 font-semibold",children:"Invite member"}),k&&(0,r.jsx)(eD.l,{variant:"primary",children:(0,r.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,r.jsx)(T.In,{className:"text-pink-500",icon:p.R2D}),(0,r.jsxs)("p",{className:"text-sm",children:["Projects in ",n.subscriptionType," accounts can have up to"," ",null==h?void 0:h.project.members," members. To invite additional members, please"," ",(0,r.jsx)(C.N,{variant:"underline",className:"font-semibold",...l.workspacePlan({}),children:"subscribe to the Pro plan"}),"."]})]})}),!k&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(eB.u,{confirmationAction:b,disabled:!u.Admin,project:n})})]}),(0,r.jsx)("div",{className:"pt-8"}),y&&(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Invited members will only have access to this project, not the entire team."}),c.ownershipTransferId&&(0,r.jsx)(eJ,{projectId:n.id,ownershipTransferId:c.ownershipTransferId.toString()}),(0,r.jsx)("h4",{className:"mb-4 text-h4 font-semibold",children:"Project members"}),u.Read&&(0,r.jsx)(eV.s,{projectId:n.id,hideActions:!u.Write}),!u.Read&&(0,r.jsx)(eW.e,{})]})}var eH=n(1508),eX=n(59613),eZ=n(99231),eK=n(66767),eQ=n(5953),e0=n(69444),e1=n(43308),e4=n(80374),e6=n(44661),e5=n(81009),e2=n(45047),e8=n(96429),e3=n(8289),e7=n(79060);let e9=()=>{let e=(0,i.md)(w.T6);return(0,r.jsxs)(B.T,{children:[(0,r.jsxs)(B.T,{space:2,className:"mb-5",children:[(0,r.jsx)(P.f_,{children:"Shared Variables"}),(0,r.jsx)(P.zb,{children:"Variables that can be referenced by multiple services within an environment."})]}),(0,r.jsx)(B.T,{space:3,children:null==e?void 0:e.environments.map(e=>(0,r.jsx)(te,{projectId:e.projectId,environment:e},e.id))})]})},te=e=>{var t;let{projectId:n,environment:s}=e,{id:a}=s,l=(0,i.md)(w.T6),c=(0,i.md)(f.mz),{track:d}=(0,eU.j)(),[m,u]=(0,o.useState)(!1),{order:x,setOrder:h}=(0,e0.R)(a),j=(0,i.md)((0,e1.D7)(s.id)),g=(0,i.md)((0,D.pG)(s.id)),b=Object.values(null!=(t=null==g?void 0:g.sharedVariables)?t:{}).length,y=(0,o.useMemo)(()=>{var e,t,n;let r=Object.entries(null!=(e=null==g?void 0:g.sharedVariables)?e:{}).filter(e=>{let[,t]=e;return null!=t}).map(e=>{let[t,n]=e;return{name:t,value:n.value,referencedBy:[],isSealed:!!(null==n?void 0:n.isSealed)}});for(let e of r){let r=Object.entries(null!=(t=null==g?void 0:g.services)?t:{}).map(e=>{var t;let[n,r]=e;return{serviceId:n,variables:null!=(t=r.variables)?t:{}}}),s=[];for(let{serviceId:t,variables:a}of r)for(let[r,l]of Object.entries(a))null!=l&&(0,eX.containsReference)(null!=(n=l.value)?n:"","".concat(eK.MS,".").concat(e.name))&&s.push({serviceId:t,name:r});e.referencedBy=s}return r},[g,b]),N=(0,o.useMemo)(()=>(0,eH.sortVariablesByOrder)({order:x,variables:null!=y?y:[]}),[x,y]),I=(0,o.useMemo)(()=>N.map(e=>({value:(0,eX.buildTemplateTag)({variableName:e.name})})),[N]),{unrenderedVariables:C}=(0,eZ.U7)({projectId:n,environmentId:a,pluginId:null,serviceId:null,enabled:c}),R=(0,o.useMemo)(()=>null==C?null:(0,eH.sortVariablesByOrder)({order:x,variables:Object.entries(C).map(e=>{let[t,n]=e;return{name:t,value:n}})}).reduce((e,t)=>{let{name:n,value:r}=t;return{...e,[n]:r}},{}),[x,C]),{upsertVariable:M,upsertVariables:U,setVariablesFromObject:_,configureSharedVariables:W,deleteVariable:V,onSealVariable:F}=(0,eQ.m)({projectId:n,environment:s,environmentConfig:g,pluginId:null,serviceId:null}),{modalActions:z}=(0,v.U)(),[L,O]=(0,o.useState)(!1),$=async e=>{let{name:t,referencingServices:n}=e;if(null==l)return;let s=async e=>{let{variableNames:t,serviceMap:n}=e;await W({names:t,serviceMap:n})};z.openModal((0,r.jsx)(ts,{onSave:s,project:l,environmentConfig:g,variableName:t,allVariableNames:N.map(e=>e.name),referencingServices:n}))},Y=async e=>{let{name:t,value:n}=e;z.createToast((0,r.jsx)(S.y8,{title:"Shared variable created",variant:"success",description:"It can now be added to services",actionTitle:"Share with services",onClick:()=>$({name:t,referencingServices:[]})})),await M({name:t,value:n})};return(0,r.jsxs)("div",{className:"border rounded-md border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between space-x-8 px-3",children:[(0,r.jsxs)("button",{"aria-controls":s.name,"aria-expanded":!!m&&"true",onClick:()=>{c&&(d({action:m?"Close":"Open",object:"Shared Variables"}),u(!m))},className:"flex items-center space-x-3 w-full h-full py-3",children:[c&&(0,r.jsx)(T.In,{icon:m?p.yQN:p.c_$,className:"text-gray-600"}),(0,r.jsx)(P.TT,{children:s.name})]}),(0,r.jsxs)(B.z,{align:"center",space:3,children:[null==g?(0,r.jsx)(E.Rh,{className:"text-gray-500"}):(0,r.jsx)(r.Fragment,{children:null!=y&&(0,r.jsx)(P.xC,{className:"whitespace-nowrap",children:"".concat(N.length," ").concat((0,e4.td)("variable",N.length))})}),(0,r.jsx)(A.n4,{children:(0,r.jsx)(k.K0,{size:"sm",variant:"ghost",title:"Raw Shared Variable Editor",color:"gray",icon:p.rTt,iconStyles:"text-gray-600",onClick:()=>{null!=R&&z.openModal((0,r.jsx)(G.aF,{title:"Raw Environment Variable Editor",className:"md:min-w-[640px]",children:(0,r.jsx)(e3.N,{variables:R,setVariables:async e=>{O(!0),h(Object.keys(e)),await _({variables:e}),O(!1)}})}))},isLoading:L})})]})]}),(0,r.jsxs)(e5.M,{isOpen:m,className:"border-t border-gray-100",children:[(0,r.jsxs)(B.T,{space:1,className:"py-1",children:[(0,r.jsx)(A.n4,{children:(0,r.jsx)(e2._x,{hideAutocompleteHint:!0,autocompleteOptions:I,onAddVariable:Y,onAddMultipleVariables:U,checkConflict:e=>N.some(t=>t.name===e),className:"mx-4 my-2"})}),null!=l&&null!=R&&N.map(e=>{var t;return(0,r.jsx)(tt,{project:l,environmentId:a,variable:e,isStaged:(null==j||null==(t=j.sharedVariables)?void 0:t[e.name])!=null,decryptedVariables:R,upsertVariable:M,deleteVariable:V,shareVariable:$,...!e.isSealed&&{onSealVariable:F}},e.name)})]}),0===N.length&&(0,r.jsx)(B.z,{justify:"center",className:"dark:bg-gray-100 bg-secondaryBg rounded-md p-3 mx-3 mb-3",children:(0,r.jsx)(P.xC,{children:"No shared variables yet"})})]})]})},tt=e=>{var t;let{project:n,environmentId:s,variable:a,isStaged:l,decryptedVariables:i,upsertVariable:c,deleteVariable:m,shareVariable:u,onSealVariable:x}=e,{isConfirmed:h}=(0,d.S)(),j=(0,o.useMemo)(()=>{let e={};for(let t of a.referencedBy){let{serviceId:r}=t;if(null==r)continue;let s=n.services.find(e=>e.id===t.serviceId);null!=s&&(e[r]=s)}return Object.values(e)},[a.referencedBy,n.services]),p=async e=>{let{name:t,value:n}=e;await c({name:t,value:n})},v=async()=>{(!(j.length>0)||await h({confirmLabel:"Delete",title:"Delete Shared Variable",message:(0,r.jsxs)(r.Fragment,{children:["Are you sure you want to delete"," ",(0,r.jsx)(P.R0,{children:a.name}),"? This will unshare it with"," ",(0,e4.td)("service",j.length)," ",(0,r.jsx)(tr,{projectId:n.id,services:j}),"."]})}))&&await m({name:a.name})},g=null!=(t=a.value)?t:(null!=i?i:{})[a.name];return(0,r.jsx)(e8._,{skipConfirmation:!0,name:a.name,value:null!=g?g:null,isStaged:l,isSealed:a.isSealed,componentLeft:(0,r.jsx)(tn,{variable:a,referencingServices:j,projectId:n.id}),isShared:a.referencedBy.length>0,onShare:e=>{let{name:t}=e;return u({name:t,referencingServices:j})},onEdit:p,onDelete:v,onSeal:x},a.name)},tn=e=>{let{variable:t,referencingServices:n,projectId:s}=e;return(0,r.jsx)(V.m,{content:0===n.length?"Not shared with any services":(0,r.jsxs)(r.Fragment,{children:["Shared with"," ",(0,r.jsx)(tr,{asLinks:!0,projectId:s,services:n})]}),children:(null==t?void 0:t.isSealed)?(0,r.jsx)(T.In,{icon:p.X_F,className:"text-gray-400",size:"sm"}):(0,r.jsx)("div",{className:(0,N.xW)("flex justify-center items-center rounded w-[1.8em] h-[1.6em] flex-none text-xs opacity-70 hover:opacity-100",n.length>0?"text-gray-800 bg-gray-200 dark:bg-gray-300":"text-yellow-800 bg-yellow-200 dark:bg-yellow-300"),children:n.length||"!"})})},tr=e=>{let{services:t,projectId:n,asLinks:s=!1}=e,{routes:a}=(0,x.c)();return 0===t.length?(0,r.jsx)("span",{className:"italic",children:"no services"}):(0,r.jsx)(r.Fragment,{children:t.map((e,t,l)=>{let{length:i}=l;return(0,r.jsxs)(o.Fragment,{children:[t>0&&(t===i-1?" and ":", "),(0,r.jsx)("span",{className:"font-bold whitespace-nowrap",children:s?(0,r.jsx)(C.N,{variant:"underline",...a.projectServiceVariables({projectId:n,serviceId:e.id}),children:e.name}):e.name})]},t)})})},ts=e=>{let{onSave:t,project:n,environmentConfig:s,referencingServices:a,variableName:l,allVariableNames:i}=e,c=n.services,{routes:d}=(0,x.c)(),m=(0,o.useMemo)(()=>c.reduce((e,t)=>({...e,[t.id]:a.some(e=>e.id===t.id)}),{}),[a]),[u,h]=(0,o.useState)(m),[j,g]=(0,o.useState)(new Set([l])),b=(0,o.useMemo)(()=>i.filter(e=>e!==l),[i]),[f,y]=(0,o.useState)(!1),{modalActions:w}=(0,v.U)(),N=async()=>{let e=Object.keys(u).filter(e=>{var t;return m[e]!==u[e]&&!!(null==(t=s.services)?void 0:t[e])});if(!e.length)return void w.exitModal();y(!0);let n={};for(let t of e)n[t]=u[t];try{await t({variableNames:Array.from(j),changedServiceIds:e,serviceMap:n})}finally{w.exitModal(),y(!1)}},T=(0,o.useMemo)(()=>Object.values(n.services).sort((e,t)=>e.name.localeCompare(t.name)).filter(e=>{var t;return!!(null==(t=s.services)?void 0:t[e.id])}),[c]);return(0,r.jsxs)(G.aF,{title:"Raw Environment Variable Editor",className:"md:min-w-[640px]",children:[(0,r.jsx)(G.wt,{className:"mb-2",children:"Configure Shared Variable"}),(0,r.jsxs)(G.xW,{className:"mb-6",children:["Select the services to share ",(0,r.jsx)(P.R0,{children:l})," ","with. This will create a variable in each service that references the shared variable."]}),(0,r.jsxs)(eu.lV,{onSubmit:N,children:[(0,r.jsxs)(B.T,{space:1,children:[0===T.length&&(0,r.jsx)(eD.l,{variant:"warning",children:(0,r.jsxs)("div",{children:["The project ",(0,r.jsx)("strong",{children:n.name})," does not contain any services."]})}),T.map(e=>(0,r.jsx)(B.z,{children:(0,r.jsx)(e6.S,{id:"service-".concat(e.id),label:e.name,checked:!!u[e.id],onChange:t=>{h(n=>({...n,[e.id]:t}))}})},e.id))]}),(0,r.jsx)(I.c,{className:"mt-6 mb-0"}),b.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e7.Z,{triggerClassName:"pl-0",title:(0,r.jsxs)("p",{className:"text-sm",children:["Copy configuration to other shared variables"," ",j.size>1?(0,r.jsxs)(r.Fragment,{children:["(",j.size-1," selected)"]}):null]}),children:(0,r.jsx)(B.T,{space:1,className:"pb-6 pt-2",children:b.map(e=>(0,r.jsx)(B.z,{className:"font-mono",children:(0,r.jsx)(e6.S,{id:"var-".concat(e),label:e,checked:j.has(e),onChange:t=>{g(n=>(t?n.add(e):n.delete(e),new Set(n)))}})},e))})}),(0,r.jsx)(I.c,{className:"mt-0 mb-0"})]}),(0,r.jsxs)(B.z,{className:"flex-wrap xs:justify-end",children:[(0,r.jsx)(C.N,{variant:"highlight",...d.docs({page:"develop/variables#shared-variables"}),className:"flex items-center space-x-1 mr-auto mt-3",children:(0,r.jsxs)(P.ax,{children:["Shared Variables Docs ",(0,r.jsx)(p.lth,{})]})}),c.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.$n,{type:"button",color:"gray",size:"sm",onClick:()=>w.exitModal(),className:"mt-3",children:"Cancel"}),(0,r.jsx)(k.$n,{type:"submit",color:"pink",size:"sm",isLoading:f,className:"mt-3 w-full xs:w-auto ml-0 xs:ml-3",children:"Update Variable"})]}):(0,r.jsx)(k.$n,{type:"button",color:"gray",size:"sm",onClick:()=>w.exitModal(),className:"mt-3",children:"Close"})]})]})]})};var ta=n(95925),tl=n(53036),ti=n(55850),to=n(5979);let tc=e=>{let{graphqlClient:t}=(0,ti.q)(),n=(0,ta.jE)(),r=e.id,s=["projectTokens",r],{data:a,isLoading:l}=(0,tl.I)({queryKey:s,queryFn:async()=>await t.projectTokens({projectId:r})}),i=a&&(0,to.nX)(a).projectTokens;return[{projectTokens:null!=i?i:null,isLoading:l},{createProjectToken:async(e,a)=>{await n.cancelQueries({queryKey:s});let l=(await t.projectTokenCreate({input:{name:e,projectId:r,environmentId:a}})).projectTokenCreate;return await n.invalidateQueries({queryKey:s}),l},deleteProjectToken:async e=>{await n.cancelQueries({queryKey:s}),await t.projectTokenDelete({id:e}),await n.invalidateQueries({queryKey:s})}}]},td=e=>{let{children:t,message:n,className:s}=e,[{user:a,isLoading:l}]=(0,g.Jd)(),{routes:i}=(0,x.c)();return l||null==a?(0,r.jsx)(E.m6,{}):a.isVerified?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsxs)(B.T,{align:"center",className:(0,N.xW)("p-8",s),children:[(0,r.jsx)(B.T,{align:"center",justify:"center",className:(0,N.xW)("h-16 w-16","bg-cover bg-[url('/illustrations/stamp.svg')]"),children:(0,r.jsx)(T.In,{icon:p.Jlk,size:"xl",className:"text-green-500"})}),(0,r.jsxs)(B.T,{align:"center",className:"text-center py-4",children:[(0,r.jsx)(P.mM,{className:"mb-3",children:"Verify your account"}),(0,r.jsx)(P.EY,{children:n})]}),(0,r.jsx)(k.vx,{color:"green",...i.verify({}),className:"max-w-max",children:"Verify Account"})]})},tm=()=>{let e=(0,i.md)(w.T6),t=(0,i.md)(b.Zy),n=(0,i.md)(f.DM);return(0,r.jsx)(r.Fragment,{children:null!=e&&null!=t&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(td,{className:"bg-gray-50 w-full rounded",message:"Your account needs to be verified to create project tokens",children:[(0,r.jsx)(tx,{project:e,activeEnvironment:t}),(0,r.jsx)(ef.h,{y:5}),(0,r.jsx)(P.f_,{className:"mb-4",children:"Your Tokens"}),n.Write?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tu,{project:e}),(0,r.jsx)(ef.h,{y:5})]}):(0,r.jsx)(eW.e,{})]})})})},tu=e=>{let{project:t}=e,[{projectTokens:n},s]=tc(t),[a,l]=(0,_.b)(),{isConfirmed:i}=(0,d.S)(),[c,m]=(0,o.useState)(!1),{routes:u}=(0,x.c)(),h=async e=>{try{if(m(!0),!await i({confirmLabel:"Delete",message:"Are you sure you want to delete the token ".concat(e.name,"? Anything using this token will no longer be able to access this project."),title:"Delete token"}))return;await s.deleteProjectToken(e.id)}catch(e){l(e.message)}m(!1)};return(0,r.jsxs)("div",{children:[(0,r.jsxs)(P.xC,{className:"mb-6",children:["Anyone with any of your tokens has access to your project environment variables. Be careful. Visit the"," ",(0,r.jsx)(C.N,{variant:"underline",...u.docs({page:"deploy/integrations#project-tokens"}),children:"Tokens Documentation"}),"."]}),a&&(0,r.jsx)(P.yn,{children:a}),null==n?(0,r.jsx)(E.m6,{}):(0,r.jsx)(r.Fragment,{children:0===n.length?(0,r.jsx)(P.xC,{className:"flex items-center justify-center w-full border border-dashed border-gray-200 p-4 rounded-lg",children:"You have no tokens yet"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(F.J6,{children:(0,r.jsxs)(F.XI,{children:[(0,r.jsx)(F.D1,{children:(0,r.jsxs)(F.fI,{children:[(0,r.jsx)(F.A3,{children:"Name"}),(0,r.jsx)(F.A3,{children:"Token"}),(0,r.jsx)(F.A3,{children:"Environment"}),(0,r.jsx)(F.A3,{})]})}),(0,r.jsx)(F.vc,{showRowBorder:!0,children:n.map(e=>(0,r.jsxs)(F.fI,{unSelectable:!0,children:[(0,r.jsx)(F.xC,{children:e.name}),(0,r.jsx)(F.xC,{className:"text-gray-500",children:e.displayToken.substring(5)}),(0,r.jsx)(F.xC,{children:e.environment.name}),(0,r.jsx)(F.xC,{className:"text-gray-500 w-[44px]",children:(0,r.jsx)(k.K0,{title:"Delete",icon:p.TBR,onClick:()=>h(e),className:"text-gray-500"})})]},e.id))})]})}),(0,r.jsxs)(B.z,{align:"center",space:4,className:"bg-secondaryBg border border-gray-100 rounded-md px-4 py-3 mt-6",children:[(0,r.jsx)(T.In,{icon:p.R2D,className:"text-blue-500"}),(0,r.jsxs)(P.ax,{children:["Use these tokens by setting the"," ",(0,r.jsx)(P.R0,{children:"RAILWAY_TOKEN"})," environment variable"]})]})]})})]})},tx=e=>{var t;let{project:n,activeEnvironment:s}=e,a=(0,i.md)(f.mz),[,l]=tc(n),[c,d]=(0,o.useState)(null!=(t=s.id)?t:null),[m,u]=(0,o.useState)(""),[x,h]=(0,_.b)(),[j,p]=(0,o.useState)(null),[v,g]=(0,o.useState)(!1),b=async()=>{let e=null!=c?c:s.id;if(""!==m.trim()&&null!=e){try{g(!0);let t=await l.createProjectToken(m,e);p(t),h(null),u("")}catch(e){h(e.message)}g(!1)}},y=(0,o.useMemo)(()=>n.environments.map(e=>({text:e.name,value:e.id})),[n.environments]);return(0,r.jsxs)("div",{children:[(0,r.jsx)(P.f_,{as:"h2",className:"mb-6",children:"New Token"}),x&&(0,r.jsx)(P.yn,{children:x}),null!=j?(0,r.jsxs)(B.T,{space:3,children:[(0,r.jsxs)(B.z,{align:"center",justify:"between",space:4,children:[(0,r.jsx)(P.EY,{children:"We will only show this token once"}),(0,r.jsx)(k.$n,{size:"sm",variant:"outline",onClick:()=>p(null),children:"Got it"})]}),(0,r.jsx)("div",{className:"w-full project-token",children:(0,r.jsx)(em.$,{children:j})})]}):(0,r.jsx)(eu.lV,{onSubmit:b,name:"Create Token",children:(0,r.jsxs)("div",{className:"w-full grid xs:grid-cols-[1fr_auto_auto] items-end gap-2",children:[(0,r.jsx)(ex.pd,{id:"tokenName",name:"tokenName",placeholder:"My Token",label:"Token Name",value:m,onChange:e=>u(e.target.value),disabled:!a}),(0,r.jsx)(et.l,{id:"environment",label:"Environment",options:y,onChange:d,value:null!=c?c:void 0,name:"environment",disabled:!a,className:""}),(0,r.jsx)(k.$n,{variant:"outline",disabled:""===m.trim()||v||!a,isLoading:v,className:"w-full md:max-w-max",children:"Create"})]})})]})};var th=n(4766),tj=n(57092),tp=n(46376),tv=n(35667);let tg=e=>{var t,n,s;let{project:a}=e,[{user:l}]=(0,g.Jd)(),i=(null==a?void 0:a.billingPeriod)!=null?{start:new Date(a.billingPeriod.start),end:new Date(a.billingPeriod.end)}:null,{result:o}=(0,tj.m)({projectId:a.id,billingPeriod:i}),{currentUsage:c,estimatedUsage:d}=null!=(n=o.data)?n:{},{cpuMetrics:m,memMetrics:u,diskMetrics:x,egressMetrics:h,backupMetrics:j}=null!=(s=null==(t=o.data)?void 0:t.metrics)?s:{};return o.isLoading?(0,r.jsx)(E.m6,{}):o.isError||null==o.data?(0,r.jsx)(P.yn,{children:"There was an error fetching the project usage."}):null==c||null==d?(0,r.jsx)(B.T,{className:"bg-gray-50 p-4 rounded-lg",children:(0,r.jsx)(P.xC,{children:"There is currently no usage data available for this project."})}):(0,r.jsxs)(B.T,{space:12,children:[(0,r.jsxs)(B.T,{space:4,children:[(0,r.jsx)(P.f_,{children:"Current Usage"}),(0,r.jsx)(B.T,{className:"border border-gray-200 p-6 rounded-lg relative",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[(0,r.jsxs)(B.T,{className:"divide-y divide-gray-100 -mt-1.5",children:[(0,r.jsx)(tp.ResourceInfoItem,{text:"Memory Usage",value:c.memoryUsageGB*th.PRICE_MINUTELY_MEM_GB}),(0,r.jsx)(tp.ResourceInfoItem,{text:"CPU Usage",value:c.cpuPercentvCPU*th.PRICE_MINUTELY_VCPU}),(0,r.jsx)(tp.ResourceInfoItem,{text:"Network Usage (Egress)",value:c.egressGB*th.PRICE_EGRESS_GB}),c.diskGB>0&&(0,r.jsx)(tp.ResourceInfoItem,{text:"Volume Usage",value:c.diskGB*th.PRICE_MINUTELY_DISK_GB}),c.backupGB>0&&(0,r.jsx)(tp.ResourceInfoItem,{text:"Backup Usage",value:c.backupGB*th.PRICE_MINUTELY_BACKUP_GB})]}),(0,r.jsx)(B.z,{space:3,children:(0,r.jsx)(tp.BillItemInfo,{text:"Current Usage",value:(0,th.costForUsageItem)(c)})})]})}),(0,r.jsx)(P.f_,{children:"Estimated Usage"}),(0,r.jsx)(B.T,{className:"border border-gray-200 p-6 rounded-lg relative",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[(0,r.jsxs)(B.T,{className:"divide-y divide-gray-100 -mt-1.5",children:[(0,r.jsx)(tp.ResourceInfoItem,{text:"Memory Usage",value:d.memoryUsageGB*th.PRICE_MINUTELY_MEM_GB}),(0,r.jsx)(tp.ResourceInfoItem,{text:"CPU Usage",value:d.cpuPercentvCPU*th.PRICE_MINUTELY_VCPU}),(0,r.jsx)(tp.ResourceInfoItem,{text:"Network Usage (Egress)",value:d.egressGB*th.PRICE_EGRESS_GB}),c.diskGB>0&&(0,r.jsx)(tp.ResourceInfoItem,{text:"Volume Usage",value:d.diskGB*th.PRICE_MINUTELY_DISK_GB}),c.backupGB>0&&(0,r.jsx)(tp.ResourceInfoItem,{text:"Backup Usage",value:d.backupGB*th.PRICE_MINUTELY_BACKUP_GB})]}),(0,r.jsx)(B.z,{space:3,children:(0,r.jsx)(tp.BillItemInfo,{text:"Estimated Usage",value:(0,th.costForUsageItem)(d)})})]})})]}),(!!(null==m?void 0:m.length)||!!(null==u?void 0:u.length)||!!(null==h?void 0:h.length)||!!(null==x?void 0:x.length))&&(0,r.jsxs)(B.T,{space:4,children:[(0,r.jsx)(P.f_,{children:"Details"}),(0,r.jsx)(B.T,{space:12,className:"bg-gray-100 px-6 py-4 overflow-hidden rounded-lg",children:(0,r.jsxs)(B.T,{space:4,children:[!!(null==m?void 0:m.length)&&(0,r.jsx)(tv.I4,{values:m,showHover:!0}),!!(null==u?void 0:u.length)&&(0,r.jsx)(tv.GC,{values:u,showHover:!0}),!!(null==h?void 0:h.length)&&(0,r.jsx)(tv.HZ,{values:h,showHover:!0}),!!(null==x?void 0:x.length)&&(0,r.jsx)(tv.Zv,{values:x,showHover:!0})]})})]}),(null==l?void 0:l.isAdmin)&&(0,r.jsx)(tb,{currentUsage:c,estimatedUsage:d})]})},tb=e=>{let{currentUsage:t,estimatedUsage:n}=e;return(0,r.jsxs)(B.T,{children:[(0,r.jsx)(P.f_,{className:"mb-6",children:"Admin stats"}),(0,r.jsx)(P.TT,{className:"mb-3",children:"Current usage"}),(0,r.jsx)(tf,{usage:t}),(0,r.jsx)(P.TT,{className:"mt-4 mb-3",children:"Estimated usage"}),(0,r.jsx)(tf,{usage:n})]})},tf=e=>{let{usage:t}=e;return(0,r.jsxs)("div",{className:"px-4 py-2 rounded bg-gray-50 font-mono whitespace-pre",children:[(0,r.jsxs)("p",{children:["Memory:","           ",t.memoryUsageGB.toFixed(2)," GB = $",(t.memoryUsageGB*th.PRICE_MINUTELY_MEM_GB).toFixed(2)]}),(0,r.jsxs)("p",{children:["CPU:","            ",t.cpuPercentvCPU.toFixed(2)," vCPU = $",(t.cpuPercentvCPU*th.PRICE_MINUTELY_VCPU).toFixed(2)]}),(0,r.jsxs)("p",{children:["Volume:","          ",t.diskGB.toFixed(2)," GB = $",(t.diskGB*th.PRICE_MINUTELY_DISK_GB).toFixed(2)]}),(0,r.jsxs)("p",{children:["Backup:","           ",t.backupGB.toFixed(2)," GB = $",(t.backupGB*th.PRICE_MINUTELY_BACKUP_GB).toFixed(2)]}),(0,r.jsxs)("p",{children:["Network Out (Tx): ",t.egressGB.toFixed(2)," GB = $",(t.egressGB*th.PRICE_EGRESS_GB).toFixed(2)]}),(0,r.jsxs)("p",{children:["Network In (Rx):","  ",t.ingressGB.toFixed(2)," GB = $",(t.ingressGB*th.PRICE_INGRESS_GB).toFixed(2)]})]})};var ty=n(97865),tw=n(72898);let tN=e=>{let{graphqlClient:t}=(0,ti.q)(),n=["project",e,"webhooks"],{result:r,setQuery:s}=(0,ty.W)(n,async()=>(await t.webhooks({projectId:e})).webhooks.edges.map(e=>e.node)),a=(0,tw.n)(n,async n=>{var a;let{url:l,filters:i}=n,o=(await t.webhookCreate({input:{projectId:e,url:l.trim(),filters:i}})).webhookCreate;s([...null!=(a=r.data)?a:[],o])}),l=(0,tw.n)(n,async e=>{var n;let{id:a,url:l,filters:i}=e;s((null!=(n=r.data)?n:[]).map(e=>e.id===a?{...e,url:l,filters:i}:e)),await t.webhookUpdate({id:a,input:{url:l.trim(),filters:i}})}),i=(0,tw.n)(n,async e=>{var n;let{id:a}=e;s((null!=(n=r.data)?n:[]).filter(e=>e.id!==a)),await t.webhookDelete({id:a})});return{webhooks:r,webhookActions:{createWebhook:a,updateWebhook:l,deleteWebhook:i}}};var tk=n(64162),tI=n(60866),tT=n.n(tI);let tC=e=>{var t,n;let{project:s,webhook:a,title:l,description:c,showClose:d}=e,[m,u]=(0,o.useState)(!1),{webhookActions:h}=tN(s.id),[{user:j}]=(0,g.Jd)(),y=a&&(a.filters||[]).length>0?tP(a.filters||[]):tP(tk.FilterableWebhookDeploymentStatuses.map(e=>e.key)),[w,N]=(0,o.useState)(y),[I,T]=(0,o.useState)(),C=(0,i.md)(b.Zy),E=(0,i.md)(f.DM),[R,M]=(0,o.useState)(null),{register:A,handleSubmit:U,formState:_,reset:D,watch:W}=(0,ed.mN)({defaultValues:{url:a?a.url:""}}),{errors:F}=_,z=null!=(n=W().url)?n:"",G=""!==z.trim(),L=!Object.values(N).includes(!0),{routes:O,navActions:Y}=(0,x.c)(),{modalActions:J}=(0,v.U)(),q=e=>{J.createToast((0,r.jsx)(S.y8,{variant:"error",title:e.message}))},H=e=>{J.createToast((0,r.jsx)(S.y8,{variant:"success",title:e}))},X=async()=>{M(-1);try{let e=AbortSignal.timeout(1e4),t=await fetch(z,{method:"POST",body:tS({project:s,user:j,activeEnvironment:C,editedURL:z}),headers:{...!z.includes("slack")&&{"Content-Type":"application/json"}},signal:e});M(t.status),T(tS({project:s,user:j,activeEnvironment:C,editedURL:z}))}catch(e){M(666),T(void 0)}},Z=async e=>{let{url:t}=e;u(!0);let n=Object.entries(w).reduce((e,t)=>{let[n,r]=t;return r?[...e,n]:e},[]),r=n.length!=tk.FilterableWebhookDeploymentStatuses.length?n:null;a&&a.id?h.updateWebhook({id:a.id,url:t,filters:r}).then(()=>{H("Webhook saved!"),Y.push(O.projectWebhooks({}))}).catch(q):h.createWebhook({url:t,filters:r}).then(()=>{H("Webhook saved!"),Y.push(O.projectWebhooks({}))}).catch(q)};return(0,r.jsxs)(B.T,{space:4,children:[(0,r.jsxs)(B.T,{children:[(0,r.jsxs)(B.z,{justify:"between",align:"center",children:[(0,r.jsx)(P.f_,{as:"h3",children:l}),(0,r.jsx)("div",{className:"".concat(!d&&"opacity-0"," mb-2"),children:(0,r.jsx)(k.K0,{icon:p.X,title:"Close",onClick:()=>{Y.push(O.projectWebhooks({}))}})})]}),c&&(0,r.jsx)(P.xC,{className:"mb-4",children:c})]}),null!=R&&R>0&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(eD.l,{variant:R>=400?"danger":"success",children:(e=>null==e?"":666===e?(0,r.jsx)("div",{children:"Request failed"}):(0,r.jsx)("span",{children:"Response status: ".concat(e)}))(R)})}),(0,r.jsx)(eu.lV,{onSubmit:U(Z),enableBindings:!0,onCancel:()=>D(),className:"mb-6",children:(0,r.jsxs)(B.T,{space:8,children:[(0,r.jsx)(ex.pd,{error:null==(t=F.url)?void 0:t.message,label:{text:"Endpoint"},...A("url",{required:!1,validate:e=>""===e||(0,$.validateUrl)(e)?void 0:"Invalid URL"}),placeholder:"https://your-webhook.com",disabled:!E.Write}),(0,r.jsx)(B.z,{className:"grid grid-4",children:(0,r.jsx)(tE,{onSelect:e=>{N(e)},selectedFilters:w})}),(0,r.jsxs)(B.z,{space:4,align:"center",justify:"between",className:"mt-6",children:[(0,r.jsx)(B.z,{space:4,children:(0,r.jsx)(k.$n,{variant:"outline",color:"gray",type:"button",onClick:X,isLoading:-1===R,disabled:!G||!E.Write,children:"Test Webhook"})}),E.Write?(0,r.jsx)(k.$n,{type:"submit",isLoading:m,disabled:!G||!L,children:"Save Webhook"}):(0,r.jsx)(V.m,{side:"top",content:(0,r.jsx)(r.Fragment,{children:"Writer permissions required"}),children:(0,r.jsx)(k.$n,{type:"submit",disabled:!0,children:"Save Webhook"})})]})]})})]})},tE=e=>{let{onSelect:t,selectedFilters:n}=e,[s,a]=(0,o.useState)(void 0),{modalActions:l}=(0,v.U)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(B.T,{className:"w-full",space:4,children:(0,r.jsxs)(B.T,{children:[(0,r.jsx)(ex.JU,{children:"Events"}),(0,r.jsx)(B.z,{space:8,className:"grid grid-cols-4 gap-4",children:tT()(tk.FilterableWebhookDeploymentStatuses,4).map(e=>(0,r.jsx)(B.T,{space:4,children:e.map(e=>(0,r.jsx)(B.T,{children:(0,r.jsx)(e6.S,{id:e.key,size:"sm",label:e.text,checked:n[e.key]||!1,onChange:r=>((e,r)=>{let l={...n,[e.key]:r};if(0==Object.values(l).filter(e=>e).length)return void a("At least one event must be selected");s&&a(void 0),t(l)})(e,r)})},e.key))},e[0].key))}),s&&(0,r.jsx)(B.T,{className:"mt-4",children:(0,r.jsxs)("span",{className:"flex items-center text-red-600 leading-[18px] font-normal text-xs",children:[(0,r.jsx)(T.In,{icon:p.RIJ,size:"sm",className:"mr-1.5"})," ","At least one event must be selected"]})})]})})})},tP=e=>tk.FilterableWebhookDeploymentStatuses.map(e=>e.key).reduce((t,n)=>({...t,[n]:e.includes(n)}),{}),tS=e=>{var t,n,r;let{project:s,activeEnvironment:a,user:l,editedURL:i}=e;return JSON.stringify((0,tk.mux)(null!=i?i:"",{type:"DEPLOY",timestamp:new Date().toISOString(),project:{id:s.id,name:s.name,description:s.description,createdAt:s.createdAt},environment:{id:null==a?void 0:a.id,name:null==a?void 0:a.name},deployment:{id:s.id,creator:{id:null!=(t=null==l?void 0:l.id)?t:null,name:null!=(n=null==l?void 0:l.name)?n:null,avatar:null!=(r=null==l?void 0:l.avatar)?r:null},meta:{}}}),null,2)};var tR=n(28592);let tM=e=>{let{webhook:t,webhookActions:n}=e,{routes:s,navActions:a}=(0,x.c)(),{isConfirmed:l}=(0,d.S)(),{modalActions:o}=(0,v.U)(),c=(0,i.md)(f.DM),[m,u]=(0,tR.T)(),h=e=>{o.createToast((0,r.jsx)(S.y8,{variant:"error",title:e.message}))};return(0,r.jsxs)(B.z,{justify:"between",align:"center",className:"border rounded-md p-4",space:4,children:[(0,r.jsxs)(B.T,{space:2,children:[(0,r.jsx)("div",{title:t.url,className:"font-mono text-sm line-clamp-2 break-all",children:t.url}),(0,r.jsx)("div",{children:(e=>{let t=(e.filters||[]).map(e=>{var t;return null==(t=tk.FilterableWebhookDeploymentStatuses.find(t=>t.key===e))?void 0:t.text}).filter(Boolean);switch(t.length){case 0:return(0,r.jsx)(P.xC,{children:"All Events"});case 1:return(0,r.jsxs)(P.xC,{children:["Triggered on\xa0",(0,r.jsx)("b",{className:"text-gray-700",children:t[0]})]});case 2:return(0,r.jsxs)(P.xC,{children:["Triggered on\xa0",(0,r.jsx)("b",{className:"text-gray-700",children:t[0]})," and ",(0,r.jsx)("b",{className:"text-gray-700",children:t[1]})]});case 3:return(0,r.jsxs)(P.xC,{children:["Triggered on\xa0",(0,r.jsx)("b",{className:"text-gray-700",children:t[0]}),", ",(0,r.jsx)("b",{className:"text-gray-700",children:t[1]})," and ",(0,r.jsx)("b",{className:"text-gray-700",children:t[2]})]});default:return(0,r.jsxs)(P.xC,{children:["Triggered on\xa0",(0,r.jsx)("b",{className:"text-gray-700",children:t[0]}),", ",(0,r.jsx)("b",{className:"text-gray-700",children:t[1]})," and ",(0,r.jsx)("b",{className:"text-gray-700",children:t[2]})," and ",(0,r.jsx)(V.m,{side:"bottom",content:(0,r.jsx)(r.Fragment,{children:t.slice(3).map(e=>e).join(", ")}),children:(0,r.jsxs)("b",{className:"text-gray-700",children:[t.length-3," other"]})}),t.length-3==1?" event":" events"]})}})(t)})]}),(0,r.jsx)(B.z,{children:c.Write&&(0,r.jsxs)(Q.ms,{children:[(0,r.jsx)(Q.Lk,{icon:p.GvN,title:"Webhook actions",className:(0,N.xW)("w-9 h-9 flex items-center justify-center text-gray-500")}),(0,r.jsxs)(Q.pm,{align:"end",children:[(0,r.jsx)(Q.tJ,{onSelect:()=>{u(t.url),o.createToast((0,r.jsx)(S.y8,{variant:"success",title:"Copied to clipboard"}))},name:"Copy",children:"Copy"}),(0,r.jsx)(Q.tJ,{onSelect:()=>{a.push(s.projectWebhooksEdit({webhookId:t.id}))},name:"Edit",children:"Edit"}),(0,r.jsx)(Q.tJ,{onSelect:async()=>{await l({confirmLabel:"Delete",message:"Are you sure you want to delete this webhook?",title:"Delete webhook"})&&await n.deleteWebhook({id:t.id}).then(()=>{o.createToast((0,r.jsx)(S.y8,{variant:"success",title:"Webhook successfully deleted"}))}).catch(h)},name:"Delete",className:"text-red-500",children:"Delete"})]})]})})]},t.id)},tA=e=>{let{action:t,project:n}=e,{webhooks:s,webhookActions:a}=tN(n.id),{query:o,routes:c,navActions:d}=(0,x.c)(),m=s.data||[],u=(0,i.md)(f.DM),h=o.webhookId?m.find(e=>e.id===o.webhookId):void 0;return s.isFetched&&0==m.length&&"new"!==t&&d.push(c.projectWebhooksNew({})),(0,r.jsxs)("div",{children:[s.isFetched&&h&&(0,r.jsx)(tU,{open:"edit"===t,onOpenChange:()=>{d.push(c.projectWebhooks({}))},formProps:{title:"Edit Webhook",project:n,webhook:h,showClose:!0}}),(0,r.jsxs)(B.z,{justify:"between",children:[(0,r.jsx)(P.f_,{as:"h2",className:"mb-4",children:"Webhooks"}),"new"!=t&&0!=m.length&&(0,r.jsx)(B.T,{children:(0,r.jsx)(k.$n,{variant:"outline",color:"gray",size:"sm",onClick:()=>{d.push(c.projectWebhooksNew({}))},disabled:!u.Write,children:"Create Webhook"})})]}),(0,r.jsxs)(P.xC,{className:"mt-2 mb-8",children:["Webhooks that will be called when a project's build or deployment status changes.",(0,r.jsx)("br",{}),"Check out the"," ",(0,r.jsx)(C.N,{href:"https://docs.railway.com/reference/webhooks",variant:"coloured",children:"webhook documentation"})," ","for more details."]}),s.isFetched&&"new"==t&&(0,r.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},exit:"collapsed",children:(0,r.jsx)(B.T,{className:"bg-gray-100 rounded-lg p-4 mb-4",children:(0,r.jsx)(tC,{title:"New Webhook",description:"Create a Webhook to allow external services to listen to events from Railway.",project:n,showClose:m.length>0})})}),(0,r.jsx)(B.T,{space:16,children:(0,r.jsx)(B.T,{children:s.isLoading?(0,r.jsx)(E.m6,{}):(0,r.jsxs)(r.Fragment,{children:[m.length>0&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(B.T,{className:"space-y-2",children:m.map(e=>(0,r.jsx)(tM,{webhook:e,webhookActions:a},e.id))})})," "]})})})]})},tU=e=>{let{open:t,onOpenChange:n,formProps:s}=e;return(0,r.jsx)(e$.a.Root,{open:t,onOpenChange:n,children:(0,r.jsx)("div",{className:"w-[700px] max-h-[40rem]",children:(0,r.jsx)(tC,{...s})})})};function t_(){let e=(0,a._)(["\n  pr-0 md:pr-4\n"]);return t_=function(){return e},e}function tD(){let e=(0,a._)(["\n  mb-4 text-h4 font-semibold\n"]);return tD=function(){return e},e}function tW(){let e=(0,a._)(["\n  col-span-8 max-w-3xl\n"]);return tW=function(){return e},e}let tB=()=>{let e=(0,i.md)(w.T6),t=(0,i.md)(b.Zy),n=(0,i.md)(f.DM),{routes:s}=(0,x.c)(),a=(0,c.z)("md"),{tabs:d,currentTab:u}=((e,t)=>{let[{user:n}]=(0,g.Jd)(),{routes:r}=(0,x.c)();return(0,m.B)((0,o.useMemo)(()=>({General:{enabled:!0,route:r.projectSettings({environmentId:e})},Usage:{enabled:!0,route:r.projectUsage({environmentId:e})},Environments:{enabled:!0,route:r.projectEnvironments({environmentId:e})},"Shared Variables":{enabled:!0,route:r.projectSharedVariables({environmentId:e})},Webhooks:{enabled:!0,route:r.projectWebhooks({environmentId:e})},WebhookNew:{enabled:!1,route:r.projectWebhooksNew({environmentId:e})},WebhookEdit:{enabled:!1,route:r.projectWebhooksEdit({environmentId:e})},Members:{enabled:!0,route:r.projectMembers({environmentId:e})},Tokens:{enabled:t.Write,route:r.projectTokens({environmentId:e})},Integrations:{enabled:null!=n&&t.Write,route:r.projectIntegrations({environmentId:e})},Danger:{enabled:t.Write,route:r.projectDanger({environmentId:e})}}),[n,t.Write]))})(null==t?void 0:t.id,n),h=(0,o.useRef)(u);return(0,o.useEffect)(()=>{null!=u&&(h.current=u)},[u]),(0,r.jsx)(l.P.div,{initial:{y:40*!a},animate:{y:0,opacity:1},exit:a?{}:{y:20,opacity:0},transition:{type:"spring",damping:30,stiffness:340},className:(0,N.xW)("metro-settings","flex flex-col overflow-hidden h-full"),children:(0,r.jsxs)("div",{className:(0,N.xW)("grid grid-rows-[auto_minmax(0px,_1fr)]","h-full bg-background dark:bg-secondaryBg border border-gray-100 overflow-hidden","md:mt-6 md:rounded-t-xl"),children:[(0,r.jsxs)("header",{className:(0,N.xW)("flex items-center justify-between","space-x-4 py-8 px-6 md:px-12 border-b border-gray-100 md:border-gray-200"),children:[(0,r.jsx)(P._B,{children:"Project Settings"}),(0,r.jsx)(k.sh,{icon:p.X,...s.project({})})]}),(0,r.jsxs)("div",{className:"grid grid-rows-[auto_minmax(0px,_1fr)] md:grid-rows-none md:grid-cols-[auto_minmax(0px,_1fr)] w-full h-full",children:[(0,r.jsx)(tV,{environmentId:null==t?void 0:t.id}),(0,r.jsx)(M.o,{tabs:d,className:"md:!hidden px-3 py-3"}),(0,r.jsx)("div",{className:"w-full px-5 md:px-0 sm:overflow-y-auto md:pl-6",children:(0,r.jsx)("div",{className:"md:max-w-container md:mx-auto lg:ml-6 py-6 md:py-12",children:null==e?(0,r.jsx)(E.m6,{}):(0,r.jsx)(r.Fragment,{children:"General"===h.current?(0,r.jsx)(tG,{project:e}):"Shared Variables"===h.current?(0,r.jsx)(tX,{}):"Usage"===h.current?(0,r.jsx)(tH,{project:e}):"Environments"===h.current?(0,r.jsx)(tL,{}):"Webhooks"===h.current?(0,r.jsx)(tO,{project:e,action:"index"}):"WebhookNew"===h.current?(0,r.jsx)(tO,{project:e,action:"new"}):"WebhookEdit"===h.current?(0,r.jsx)(tO,{project:e,action:"edit"}):"Members"===h.current?(0,r.jsx)(tY,{project:e}):"Tokens"===h.current?(0,r.jsx)(t$,{}):"Integrations"===h.current?(0,r.jsx)(tJ,{project:e}):"Danger"===h.current?(0,r.jsx)(tq,{}):(0,r.jsx)(P.yn,{children:"Page not found"})})})})]})]})},"settings")},tV=e=>{let{environmentId:t}=e,{routes:n}=(0,x.c)();return(0,r.jsxs)("aside",{className:"hidden md:block ml-12 mt-12",children:[(0,r.jsx)(tF,{link:n.projectSettings({environmentId:t}),text:"General",icon:p.wB_}),(0,r.jsx)(tF,{link:n.projectUsage({environmentId:t}),text:"Usage",icon:p.EsT}),(0,r.jsx)(tF,{link:n.projectEnvironments({environmentId:t}),text:"Environments",icon:p.gq4}),(0,r.jsx)(tF,{link:n.projectSharedVariables({environmentId:t}),text:"Shared Variables",icon:p.qzq}),(0,r.jsx)(tF,{link:n.projectWebhooks({environmentId:t}),altLinks:[n.projectWebhooksNew({environmentId:t}),n.projectWebhooksEdit({environmentId:t})],text:"Webhooks",icon:p.zoY}),(0,r.jsx)(tF,{link:n.projectMembers({environmentId:t}),text:"Members",icon:p.zWC}),(0,r.jsxs)(A.n4,{children:[(0,r.jsx)(tF,{link:n.projectTokens({environmentId:t}),text:"Tokens",icon:p.DQV}),(0,r.jsx)(tF,{link:n.projectIntegrations({environmentId:t}),text:"Integrations",icon:p.azJ}),(0,r.jsx)(tF,{link:n.projectDanger({environmentId:t}),text:"Danger",icon:p.hcu})]})]})},tF=e=>{let{text:t,link:n,altLinks:s,icon:a}=e,[l,i,o]=(0,h.y)({rotate:35}),{pathname:c}=(0,x.c)(),d=(s||[]).length>0?[...(s||[]).map(e=>e.url),n.url].includes(c):c===n.url;return(0,r.jsxs)(tz,{active:d,...n,scroll:!1,className:"sidebar-item sidebar-item-".concat(t.replace(/\s+/g,"-")," group"),onMouseEnter:o,name:"Metro Sidebar ".concat(t),children:[(0,r.jsx)(T.In,{icon:a,initial:{rotate:0},animate:l,transition:i,className:(0,N.xW)(d?"text-pink-500":"text-gray-400",!d&&"group-hover:text-gray-800")}),(0,r.jsx)(P.EY,{children:t})]})},tz=(0,N.DR)(C.N)(e=>["relative flex items-center space-x-4 md:px-3 py-2 mb-2 mx-1 rounded text-gray-600 whitespace-nowrap","hover:text-foreground hover:bg-gray-100",e.active&&"text-foreground font-medium"]),tG=e=>{let{project:t}=e,{templateActions:n}=(0,j.b)(),{modalActions:s}=(0,v.U)(),{routes:a,navActions:l}=(0,x.c)(),[c,m]=(0,o.useState)(!1),{isConfirmed:h}=(0,d.S)(),g=(0,y.I)(),b=(0,i.md)(f.DM),w=(0,i.md)(f.C4),N=async()=>{if(await h({confirmLabel:"Generate",message:"Confirming will generate a re-usable template of your project.",theme:"info",title:"Generate Template"})){m(!0);try{let e=await n.generateTemplate({projectId:t.id,teamId:t.teamId});s.createToast((0,r.jsx)(S.y8,{title:"Success!",description:"Your template was successfully created. Redirecting you for further configuration.",variant:"success",icon:p.rAV})),l.push(a.templateCreate({code:e.templateGenerate.code}))}catch(t){var e;s.createToast((0,r.jsx)(S.y8,{icon:p.X,title:"Error",description:null!=(e=null==t?void 0:t.message)?e:"There was an issue generating the template for your project. Please create one manually",variant:"error"}))}m(!1)}},T=async()=>{let{name:e,isPublic:n}=t;if(await h({confirmLabel:"Change visibility",input:e,title:"Change project visibility",message:"Are you sure you want to convert the project ".concat(e," from ").concat(n?"PUBLIC":"PRIVATE"," to  ").concat(n?"PRIVATE":"PUBLIC","?"),type:"input"}))try{await g.updateProject({isPublic:!n}),s.createToast((0,r.jsx)(S.y8,{variant:"success",title:"Project visibility updated",description:"You have successfully converted your project to a ".concat(n?"PRIVATE":"PUBLIC"," project!")}))}catch(e){var a;s.createToast((0,r.jsx)(S.y8,{icon:p.X,title:"Error",description:null!=(a=null==e?void 0:e.message)?a:"There was an issue changing the visibility of your project.",variant:"error"}))}},{showModal:C}=(0,u.h)(),E=async()=>{C(R.s,{project:t})};return(0,r.jsxs)(tZ,{children:[(0,r.jsx)(tK,{id:"info",children:"Project Info"}),(0,r.jsx)(tQ,{children:(0,r.jsx)(ep,{project:t})}),(0,r.jsx)(I.c,{className:"my-12"}),(0,r.jsx)(tK,{id:"visibility",children:"Visibility"}),(0,r.jsxs)(tQ,{className:"space-y-6",children:[(0,r.jsxs)(P.xC,{children:["This project is currently"," ",(0,r.jsx)("strong",{children:t.isPublic?"PUBLIC":"PRIVATE"}),"."," ",t.isPublic?"Public projects are visible to anyone with the URL for your project.":"Private projects are only visible to members of the project."]}),(0,r.jsx)(k.$n,{variant:"outline",type:"button",onClick:T,disabled:c||!b.Write,isLoading:c,children:"Change visibility"})]}),(0,r.jsx)(I.c,{className:"my-12"}),(0,r.jsx)(tK,{id:"generate-template",children:"Generate Template from Project"}),(0,r.jsxs)(tQ,{className:"space-y-6",children:[(0,r.jsx)(P.xC,{children:"Create a one-click template for your project that other users can use to deploy similar projects."}),(0,r.jsx)(k.$n,{variant:"outline",type:"button",onClick:N,disabled:c||!b.Write,isLoading:c,children:"Create template"})]}),b.Admin&&w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.c,{className:"my-12"}),(0,r.jsx)(tK,{id:"transfer-project",children:"Transfer Project"}),(0,r.jsxs)(tQ,{className:"space-y-6",children:[(0,r.jsx)(P.xC,{children:null==t.teamId?"Transfer the project to your Pro workspace for additional resources + shared access.":"Transfer the project to a different workspace"}),(0,r.jsx)(k.$n,{variant:"outline",type:"button",onClick:E,children:"Transfer project"})]})]})]})},tL=()=>(0,r.jsx)(tZ,{children:(0,r.jsx)(tQ,{children:(0,r.jsx)(es,{})})}),tO=e=>{let{project:t,action:n}=e;return(0,r.jsx)(tZ,{children:(0,r.jsx)(tQ,{children:(0,r.jsx)(tA,{project:t,action:n})})})},t$=()=>(0,r.jsx)(tZ,{children:(0,r.jsx)(tQ,{children:(0,r.jsx)(tm,{})})}),tY=e=>{let{project:t}=e;return(0,r.jsx)(tZ,{children:(0,r.jsx)(tQ,{children:(0,r.jsx)(eq,{project:t})})})},tJ=e=>{let{project:t}=e;return(0,r.jsx)(tZ,{children:(0,r.jsx)(tQ,{children:(0,r.jsx)(eP,{projectId:t.id})})})},tq=()=>(0,r.jsx)(tZ,{children:(0,r.jsx)(tQ,{children:(0,r.jsx)(L,{})})}),tH=e=>{let{project:t}=e;return(0,r.jsx)(tZ,{children:(0,r.jsx)(tQ,{children:(0,r.jsx)(tg,{project:t})})})},tX=()=>(0,r.jsx)(tZ,{children:(0,r.jsx)(tQ,{children:(0,r.jsx)(e9,{})})}),tZ=N.qy.section(t_()),tK=N.qy.h4(tD()),tQ=N.qy.div(tW()),t0=()=>(0,r.jsx)(tB,{}),t1=t0;t0.getLayout=s._},60866:e=>{var t=1/0,n=0/0,r=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,i=/^(?:0|[1-9]\d*)$/,o=parseInt,c=Object.prototype.toString,d=Math.ceil,m=Math.max;function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e,x,h){x=(h?function(e,t,n){if(!u(n))return!1;var r,s,a,l,o,d,m,x=typeof t;return("number"==x?!!(null!=(r=n)&&"number"==typeof(s=r.length)&&s>-1&&s%1==0&&s<=0x1fffffffffffff&&"[object Function]"!=(l=u(a=r)?c.call(a):"")&&"[object GeneratorFunction]"!=l&&(m=null==(m=n.length)?0x1fffffffffffff:m)&&("number"==typeof t||i.test(t))&&t>-1&&t%1==0&&t<m):"string"==x&&t in n)&&(o=n[t],o===(d=e)||o!=o&&d!=d)}(e,x,h):void 0===x)?1:m((v=(p=(j=x)?(j=function(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==c.call(t))return n;if(u(e)){var t,i="function"==typeof e.valueOf?e.valueOf():e;e=u(i)?i+"":i}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var d=a.test(e);return d||l.test(e)?o(e.slice(2),d?2:8):s.test(e)?n:+e}(j))===t||j===-t?(j<0?-1:1)*17976931348623157e292:j==j?j:0:0===j?j:0)%1,p==p?v?p-v:p:0),0);var j,p,v,g=e?e.length:0;if(!g||x<1)return[];for(var b=0,f=0,y=Array(d(g/x));b<g;)y[f++]=function(e,t,n){var r=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(n=n>s?s:n)<0&&(n+=s),s=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(s);++r<s;)a[r]=e[r+t];return a}(e,b,b+=x);return y}},80068:(e,t,n)=>{"use strict";n.d(t,{s:()=>P});var r=n(50979),s=n(95925),a=n(49404),l=n(81154),i=n(25963),o=n(45479),c=n(93208),d=n(55850),m=n(937),u=n(70578),x=n(70375),h=n(2551),j=n(77505),p=n(45588),v=n(73648),g=n(47188),b=n(36609),f=n(35645),y=n(31754),w=n(17057),N=n(13077),k=n(47654),I=n(67970),T=n(85018),C=n(88887);let E=[o.Mk2.Admin,o.Mk2.Member,o.Mk2.Viewer];function P(e){let{hideActions:t=!1,projectId:n}=e,{isConfirmed:l}=(0,c.S)(),[{members:o},g]=(0,u.Ff)(n),[{user:b}]=(0,p.Jd)(),{isHobby:f,isPro:y}=(0,v.hA)(),{data:w}=(0,m.HC)(n),{graphqlClient:N}=(0,d.q)(),{modalActions:T}=(0,j.U)(),{navActions:P,routes:M}=(0,x.c)(),A=(0,s.jE)(),{mutate:U,isPending:_}=(0,a.n)({mutationFn:async e=>{let{id:t}=e;return N.projectInvitationDelete({id:t})},onError:()=>{T.createToast((0,r.jsx)(C.y8,{description:"We were unable to delete your project invitation. Please contact support if this error persists.",title:"Unable to cancel invitation",variant:"error"}))},onSuccess:(e,t)=>{let{id:r}=t;A.setQueryData((0,m.Hb)(n),e=>(null!=e?e:[]).filter(e=>e.id!==r))}}),{mutate:D,isPending:W}=(0,a.n)({mutationFn:async e=>{let{id:t}=e;return N.projectInvitationResend({id:t})},onError:()=>{T.createToast((0,r.jsx)(C.y8,{description:"We were unable to resend your project invitation. Please contact support if this error persists.",title:"Unable to resend invitation",variant:"error"}))},onSuccess:e=>{let t=e.projectInvitationResend;T.createToast((0,r.jsx)(C.y8,{description:"A new project invitation has been sent to ".concat(t.email,"."),title:"Project invitation resent",variant:"success"})),A.setQueryData((0,m.Hb)(n),e=>(null!=e?e:[]).map(e=>e.id===t.id?{...e,...t}:e))}}),B=(0,i.useMemo)(()=>(null!=o?o:[]).sort((e,t)=>E.indexOf(e.role)-E.indexOf(t.role)),[o]),V=e=>{U({id:e})},F=e=>{D({id:e})},z=async(e,t)=>{try{await g.changeUserRole(e,t)}catch(e){T.createToast((0,r.jsx)(C.y8,{title:"Failed to change role",variant:"error",description:"We were unable to update the role of this user. Please contact support if this error persists."}))}},G=async()=>{try{if(!await l({confirmLabel:"Leave",message:"Are you sure you want to leave this project? You will not longer be able to access this project after you leave.",title:"Leave project"}))return;await g.leaveProject(),P.push(M.dashboard({}))}catch(e){T.createToast((0,r.jsx)(C.y8,{title:"Unable to leave project",variant:"error",description:"We were unable to remove you from this project. Please contact support if this error persists."}))}},L=async e=>{try{if(!await l({confirmLabel:"Remove",title:"Remove member",message:"Are you sure you want to remove ".concat(e.email," from the project?")}))return;await g.removeUserFromProject(e.id)}catch(t){T.createToast((0,r.jsx)(C.y8,{title:"Failed to remove user",variant:"error",description:"We were unable to remove ".concat(e.email," from this project. Please contact support if this error persists.")}))}},O=async e=>{if(!f&&!y){await l({confirmLabel:"Upgrade",message:"Free plan users cannot transfer projects. Please upgrade to the Hobby Plan to transfer the ownership of this project.",theme:"info",title:"Upgrade to the Hobby Plan"})&&P.push(M.workspaceUpgrade({}));return}try{if(!await l({confirmLabel:"Transfer",message:"Are you sure you want to transfer the ownership of this project to ".concat(e.email,"?"),title:"Transfer ownership"}))return;await g.initiateOwnershipTransfer({projectId:n,memberId:e.id}),T.createToast((0,r.jsx)(C.y8,{title:"Transfer initiated",description:"".concat(e.email," will receive an email to confirm the transfer. They must accept it within 24 hours or you will have to initiate the transfer again."),icon:h.gE4}))}catch(e){T.createToast((0,r.jsx)(C.y8,{title:"Failed to initiate transfer",variant:"error",description:e.message}))}};return null===o||void 0===w?(0,r.jsx)(I.m6,{}):t||0!==o.length||0!==w.length?(0,r.jsxs)("div",{className:"flex flex-col border border-gray-100 rounded-md pt-4",children:[(0,r.jsxs)("div",{className:"flex items-start px-3 pb-4",children:[(0,r.jsx)("p",{className:"flex-1 text-left font-semibold text-xs text-gray-600",children:"Name"}),(0,r.jsx)("p",{className:"flex-1 text-left font-semibold text-xs text-gray-600",children:"Permissions"})]}),(0,r.jsxs)(r.Fragment,{children:[B.map(e=>(0,r.jsxs)(i.Fragment,{children:[!(null==b?void 0:b.isAdmin)&&(0,r.jsx)(R,{hideActions:t,member:e,onChangeRole:z,onLeaveProject:G,onRemoveMember:L,onTransferOwnership:O}),(null==b?void 0:b.isAdmin)&&(0,r.jsx)(k.N,{className:"hover:bg-gray-100",...M.adminUsers({id:e.id}),children:(0,r.jsx)(R,{hideActions:t,member:e,onChangeRole:z,onLeaveProject:G,onRemoveMember:L,onTransferOwnership:O})})]},e.id)),(null!=w?w:[]).map(e=>(0,r.jsx)(S,{hideActions:t,disabled:_||W,invitation:e,onCancelInvite:V,onResendInvite:F},e.id))]})]}):(0,r.jsxs)("div",{className:"bg-gray-200/75 flex flex-col gap-y-1 items-center justify-center rounded-md py-12 outline-dashed outline-1 outline-gray-200",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Invite project members"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 text-center md:w-1/2",children:"Invited members will only have access to this project, not the entire team."})]})}function S(e){let{hideActions:t=!1,disabled:n=!1,invitation:s,onCancelInvite:a,onResendInvite:i}=e,o=(0,l.md)(g.uV);return(0,r.jsxs)("div",{className:"flex flex-row items-center border-t border-gray-100 px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex flex-1 items-center gap-x-4",children:[(0,r.jsx)(f.e,{email:s.email,size:"sm"}),(0,r.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,r.jsx)("p",{className:"text-base truncate max-w-[120px] md:max-w-none",children:"Pending member"}),(0,r.jsx)("p",{className:"text-xs text-gray-600 font-medium truncate max-w-[120px] md:max-w-none",children:s.email})]})]}),(0,r.jsxs)("div",{className:"flex flex-row-reverse gap-x-3 justify-end items-center",children:[!t&&o&&(0,r.jsxs)(w.ms,{children:[(0,r.jsx)(w.Lk,{icon:h.GvN,title:"Invitation actions"}),(0,r.jsxs)(w.pm,{align:"end",children:[(0,r.jsx)(w.tJ,{disabled:n,onSelect:()=>{i(s.id)},children:(0,r.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,r.jsx)(N.In,{icon:h.gE4}),(0,r.jsx)("p",{className:"text-sm text-foreground",children:"Resend invite"})]})}),(0,r.jsx)(w.tJ,{disabled:n,onSelect:()=>{a(s.id)},children:(0,r.jsxs)("div",{className:"flex items-center gap-x-4 text-red-500",children:[(0,r.jsx)(N.In,{icon:h.TBR}),(0,r.jsx)("p",{className:"text-sm",children:"Cancel invite"})]})})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 border border-gray-100 select-none rounded-md px-2 py-1",children:[s.isExpired&&(0,r.jsx)("p",{className:"text-sm text-foreground",children:"Invite expired"}),!s.isExpired&&(0,r.jsx)("p",{className:"text-sm text-foreground",children:"Invite pending"})]})]})]})}function R(e){var t;let{hideActions:n=!1,member:s,onChangeRole:a,onLeaveProject:i,onRemoveMember:c,onTransferOwnership:d}=e,[{user:m}]=(0,p.Jd)(),x=(0,l.md)(g.uV),j=u.zF.some(e=>e.value===s.role),v=x&&(null==m?void 0:m.id)!==s.id;return(0,r.jsxs)("div",{className:"flex flex-row items-center border-t border-gray-100 px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex flex-1 items-center gap-x-4",children:[(0,r.jsx)(f.e,{avatar:null==s?void 0:s.avatar,email:null==s?void 0:s.email,size:"sm"}),(0,r.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,r.jsx)("p",{className:"text-base truncate max-w-[120px] md:max-w-none",children:null!=(t=s.name)?t:s.email}),(null==s?void 0:s.name)&&(0,r.jsx)("p",{className:"text-xs text-gray-600 font-medium truncate max-w-[120px] md:max-w-none",children:s.email})]})]}),(0,r.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[v&&j?(0,r.jsx)(T.l.Root,{id:"role-select",label:"Permission",onValueChange:e=>{a(s.id,e)},value:s.role,visuallyHideLabel:!0,children:u.zF.map(e=>(0,r.jsx)(T.l.Item,{value:e.value,children:e.text},e.value))}):(0,r.jsx)("p",{className:(0,b.xW)(["text-base",s.role===o.Mk2.Admin&&"text-gray-600"]),children:u.sC[s.role]}),!n&&v&&(0,r.jsxs)(w.ms,{children:[(0,r.jsx)(w.Lk,{icon:h.GvN,title:"Member actions"}),(0,r.jsxs)(w.pm,{align:"end",children:[s.role===o.Mk2.Member&&(0,r.jsx)(w.tJ,{onSelect:()=>{d(s)},children:"Transfer ownership"}),(0,r.jsx)(w.tJ,{className:"text-red-500",onSelect:()=>{c(s)},children:"Remove user"})]})]}),!v&&s.role!==o.Mk2.Admin&&(null==m?void 0:m.id)===s.id&&(0,r.jsx)(y.$n,{color:"red",onClick:i,size:"sm",children:"Leave"})]})]})}},94815:(e,t,n)=>{"use strict";n.d(t,{S:()=>d});var r=n(50979),s=n(36609),a=n(53309),l=n(30843),i=n(7776),o=n(58213),c=n(70254);let d=e=>{let{centerVertically:t,mainStyle:n,maxWidth:d,children:m,withBrandNavbar:u=!1,withBrandFooter:x=!1,...h}=e;return(0,r.jsxs)(i.YS,{...h,children:[u?(0,r.jsx)(o.M,{}):(0,r.jsx)(l.F,{}),(0,r.jsx)("main",{className:(0,s.xW)("grid px-5 md:px-8 mb-20",t&&"items-center pb-20 md:pb-60","[min-height:calc(100vh-theme(height.header))]",n),children:(0,r.jsx)("div",{className:(0,s.xW)("flex flex-col items-center mx-auto",t&&"justify-center",d||"max-w-container"),children:m})}),x?(0,r.jsx)(c.p,{}):(0,r.jsx)(a.w,{})]})}}}]);